<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Delta Cq 96-well plate qPCR analysis example • tidyqpcr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Delta Cq 96-well plate qPCR analysis example">
<meta property="og:description" content="tidyqpcr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidyqpcr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/calibration_vignette.html">Primers and probes calibration vignette</a>
    </li>
    <li>
      <a href="../articles/deltacq_96well_vignette.html">Delta Cq 96-well plate qPCR analysis example</a>
    </li>
    <li>
      <a href="../articles/multifactor_vignette.html">Multifactorial multi-plate qPCR analysis example</a>
    </li>
    <li>
      <a href="../articles/platesetup_vignette.html">Introduction to designing an experiment and setting up a plate plan in tidyqpcr</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ewallace/tidyqpcr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Delta Cq 96-well plate qPCR analysis example</h1>
                        <h4 data-toc-skip class="author">Stuart McKellar and Edward Wallace</h4>
            
            <h4 data-toc-skip class="date">July 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ewallace/tidyqpcr/blob/master/vignettes/deltacq_96well_vignette.Rmd" class="external-link"><code>vignettes/deltacq_96well_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>deltacq_96well_vignette.Rmd</code></div>

    </div>

    
    
<div id="summary-an-example-96-well-qpcr-experiment-" class="section level1">
<h1 class="hasAnchor">
<a href="#summary-an-example-96-well-qpcr-experiment-" class="anchor" aria-hidden="true"></a>Summary: an example 96-well qPCR experiment.</h1>
<p>This vignette shows how to use tidyqpcr functions to normalize and plot data from a single RT-qPCR experiment on a 96-well plate. We include relative quantification, calculations of delta Cq (within-sample normalization) and delta delta Cq (between-sample normalization), with some example plots.</p>
<p>This is real RT-qPCR data by Stuart McKellar:</p>
<p>Aim: to measure expression of two mRNAs and one reference control in two strains of bacteria at various growth stages (measured by OD: 0.5, 1.5, 3, 6, and overnight culture, ‘ODON’).</p>
<p>mRNAs: GlyS and SpoVG with 5S rRNA used as a reference control.</p>
<p>Bacterial strains: wild-type (WT) and mutant (dAgr).</p>
<p>Equipment: Data were collected on a Roche LightCycler 480, and LightCycler software used to estimate Cq/Ct values and export that as a text-format table. The sample information is specified in this input data file.</p>
</div>
<div id="loading-organizing-and-sanity-checking-data-" class="section level1">
<h1 class="hasAnchor">
<a href="#loading-organizing-and-sanity-checking-data-" class="anchor" aria-hidden="true"></a>Loading, organizing, and sanity-checking data.</h1>
<div id="load-data-from-machine-output-file" class="section level2">
<h2 class="hasAnchor">
<a href="#load-data-from-machine-output-file" class="anchor" aria-hidden="true"></a>Load data from machine output file</h2>
<p>We start by loading data from the experiment. We print the data to screen here, it is always a good idea to look at the data to find out if it has loaded correctly and behaves as expected, or not.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>

<span class="va">plate_cq_extdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,
    <span class="st">"Stuart_dAgr_glyS_spoVG_5S_individualWells_Cq_select.txt"</span>,
    package <span class="op">=</span> <span class="st">"tidyqpcr"</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">plate_cq_extdata</span></code></pre></div>
<pre><code>## # A tibble: 90 x 3
##    well  sample_info      cq
##    &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;
##  1 A1    WT OD0.5 glyS  14.0
##  2 A2    WT OD0.5 glyS  13.9
##  3 A3    WT OD0.5 glyS  14.0
##  4 A4    WT OD1.5 glyS  14.6
##  5 A5    WT OD1.5 glyS  16.1
##  6 A6    WT OD1.5 glyS  14.4
##  7 A7    WT OD3 glyS    15.6
##  8 A8    WT OD3 glyS    15.6
##  9 A9    WT OD3 glyS    15.5
## 10 A10   WT OD6 glyS    12.8
## # … with 80 more rows</code></pre>
<p>Printing the data here shows that the <code>sample_info</code> column contains information on the sample. We still need to organize this information that is already associated with the data.</p>
<p>The <a href="platesetup_vignette.html">plate setup vignette</a> describes how to “set up” a plate plan to put sample information in, if your input data does not already contain sample information.</p>
<p>Note that we “cleaned up” the data file for this vignette, to remove irrelevant rows and columns. For information about how to load Cq data directly from LightCycler outputs, see <code><a href="../reference/read_lightcycler_1colour_cq.html">?read_lightcycler_1colour_cq</a></code>.</p>
</div>
<div id="organize-sample-and-target-data-on-the-plate" class="section level2">
<h2 class="hasAnchor">
<a href="#organize-sample-and-target-data-on-the-plate" class="anchor" aria-hidden="true"></a>Organize sample and target data on the plate</h2>
<p>The <code>sample_info</code> column contains values like <code>WT OD0.5 glyS</code>, where <code>WT</code> describes the strain, <code>OD0.5</code> describes the growth stage (optical density), and <code>glyS</code> describes the target gene that is detected. These three pieces of information are delimited by spaces. We use the <code>separate</code> function, from the <code>tidyr</code> package, to separate the three pieces of information in <code>sample_info</code> into three columns, (<code>strain</code>, <code>OD</code>, <code>target_id</code>), each of which contains a single piece of information. Note that tidyqpcr insistently refers to the targets detected in a qPCR experiment as <code>target_id</code>, as they could be primer sets or hydrolysis probes targeting distinct gene regions, RNA isoforms, SNPs, or chromosomal locations for ChIP studies. In this experiment we have three amplicons, each from a different RNA.</p>
<p>However, tidyqpcr expects a column called <code>sample_id</code> that identifies the unique sample - here, that would be identified by a strain (e.g. <code>WT</code>) and growth stage (e.g. <code>OD0.5</code>). So we use the <code>unite</code> function, from the <code>tidyr</code> package, to create a new column <code>sample_id</code> that unites strain and OD.</p>
<p>Before these, we have to do a little organization. Wee add row and column labels for each well, so that we can later draw the plate plan and check the description. We use the tidyqpcr function <code>create_blank_plate_96well</code> to make a “blank” plate plan, then join that information to the data. The join function <code>inner_join</code> is in the <code>dplyr</code> package.</p>
<p>We use the tidyverse pipe operator <code>%&gt;%</code> to do all these transformations in a row, with one on each line.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plate_cq_data</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/create_blank_plate.html">create_blank_plate_96well</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># row and column labels for each well</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">plate_cq_extdata</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># join that info to loaded data</span>
  <span class="co"># next separate the sample and target information for future data analysis</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">sample_info</span>,
           into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"strain"</span>,<span class="st">"OD"</span>,<span class="st">"target_id"</span><span class="op">)</span>, 
           sep <span class="op">=</span> <span class="st">" "</span>,
           remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html" class="external-link">unite</a></span><span class="op">(</span><span class="st">"sample_id"</span>,<span class="va">strain</span>, <span class="va">OD</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># put sample_id together</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>prep_type <span class="op">=</span> <span class="st">"+RT"</span><span class="op">)</span> <span class="co"># add information on cDNA prep type</span>

<span class="va">plate_cq_data</span></code></pre></div>
<pre><code>## # A tibble: 90 x 10
##    well  well_row well_col sample_info sample_id strain OD    target_id    cq
##    &lt;chr&gt; &lt;fct&gt;    &lt;fct&gt;    &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;
##  1 A1    A        1        WT OD0.5 g… WT_OD0.5  WT     OD0.5 glyS       14.0
##  2 A2    A        2        WT OD0.5 g… WT_OD0.5  WT     OD0.5 glyS       13.9
##  3 A3    A        3        WT OD0.5 g… WT_OD0.5  WT     OD0.5 glyS       14.0
##  4 A4    A        4        WT OD1.5 g… WT_OD1.5  WT     OD1.5 glyS       14.6
##  5 A5    A        5        WT OD1.5 g… WT_OD1.5  WT     OD1.5 glyS       16.1
##  6 A6    A        6        WT OD1.5 g… WT_OD1.5  WT     OD1.5 glyS       14.4
##  7 A7    A        7        WT OD3 glyS WT_OD3    WT     OD3   glyS       15.6
##  8 A8    A        8        WT OD3 glyS WT_OD3    WT     OD3   glyS       15.6
##  9 A9    A        9        WT OD3 glyS WT_OD3    WT     OD3   glyS       15.5
## 10 A10   A        10       WT OD6 glyS WT_OD6    WT     OD6   glyS       12.8
## # … with 80 more rows, and 1 more variable: prep_type &lt;chr&gt;</code></pre>
<p>Again, we print the table to check that the columns and data are correct.</p>
</div>
<div id="display-the-plate-layout" class="section level2">
<h2 class="hasAnchor">
<a href="#display-the-plate-layout" class="anchor" aria-hidden="true"></a>Display the plate layout</h2>
<p>It is easier to understand pictures than tables of text. To display the layout of samples within a microplate, tidyqpcr has a function <code>display_plate</code>. We use that here to show how the samples are laid out within the plate.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/display_plate.html">display_plate</a></span><span class="op">(</span><span class="va">plate_cq_data</span><span class="op">)</span></code></pre></div>
<p><img src="deltacq_96well_vignette_files/figure-html/display_plates-1.png" width="864"></p>
<p>Here, the different colours indicate different <code>target_ids</code>, which is default behaviour of <code>display_plate</code>. This display makes it possible to see that there are three identically-labeled wells - technical replicates - in a row.</p>
</div>
<div id="plot-unnormalized-cq-data" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-unnormalized-cq-data" class="anchor" aria-hidden="true"></a>Plot unnormalized Cq data</h2>
<p>Next we plot all the data to visualise the unnormalised data points. These visual explorations are a crucial sanity check, both on the data itself, and also on any possible mistakes made when loading the data and assigning labels.</p>
<p>Here we use functions from <code>ggplot</code> to plot the data. The interesting output is Cq values, which go on the y axis. The data measures three target genes in two strains in five different growth conditions. So the first plot we make has one plot panel or facet for each growth condition. Each facet shows values for all three targets and two strains, with the targets on the x-axis and strains indicated by colour and shape.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plate_cq_data</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">target_id</span>, y <span class="op">=</span> <span class="va">cq</span>, shape <span class="op">=</span> <span class="va">strain</span>, colour <span class="op">=</span> <span class="va">strain</span><span class="op">)</span>,
    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"Quantification cycle (Cq)"</span>,
    title <span class="op">=</span> <span class="st">"All reps, unnormalized"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">OD</span>,ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="deltacq_96well_vignette_files/figure-html/plot_unnormalized-1.png" width="384"></p>
<p>The plot shows that Cq values for 5S are reproducible and very low (Cq about 5) for all samples. That makes biological sense as 5S ribosomal rRNA is extremely abundant.</p>
<p>More generally, the plot shows that the technical replicates are very close together. Technical replicates are expected to be close to each other, so this observation visually confirms that we have labeled the wells correctly.</p>
</div>
</div>
<div id="normalized-data-delta-cq" class="section level1">
<h1 class="hasAnchor">
<a href="#normalized-data-delta-cq" class="anchor" aria-hidden="true"></a>Normalized data: delta Cq</h1>
<div id="normalize-cq-to-5s-rrna-within-sample-only" class="section level2">
<h2 class="hasAnchor">
<a href="#normalize-cq-to-5s-rrna-within-sample-only" class="anchor" aria-hidden="true"></a>Normalize Cq to 5S rRNA, within Sample only</h2>
<p>Next we “normalize” by calculating delta Cq () for each target in each sample. We treat the 5S rRNA as a reference gene, and for other mRNA targets estimate a <code>delta_cq</code> value of the difference against the median value for 5S rRNA within the same sample. This normalisation is performed by the <code>calculate_deltacq_bysampleid</code> function. This function works as follows:</p>
<ul>
<li>You provide the data and the name of the reference gene (i.e. <code>ref_target_ids = "5S"</code>)</li>
<li>The function will calculate the median Cq of the reference gene separately for each sample</li>
<li>Then the function will subtract that value from the Cq for every other measured gene, again separately for each sample, adding a <code>delta_cq</code> column to its output data</li>
<li>The function also calculates relative abundance or normalized ratio to the reference targets, , adding a <code>rel_abund</code> column to its output data.</li>
</ul>
<p>If you use <em>multiple</em> reference target ids, the function will take the median across Cq values of <em>all</em> the reference target ids. You can also ask the function to use a different summary, e.g. mean instead of median. See the help file <code><a href="../reference/calculate_deltacq_bysampleid.html">?calculate_deltacq_bysampleid</a></code> for more details.</p>
<p>As ever, we print the data to screen as a sanity check.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plate_norm</span> <span class="op">&lt;-</span> <span class="va">plate_cq_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/calculate_deltacq_bysampleid.html">calculate_deltacq_bysampleid</a></span><span class="op">(</span>ref_target_ids <span class="op">=</span> <span class="st">"5S"</span><span class="op">)</span>

<span class="va">plate_norm</span></code></pre></div>
<pre><code>## # A tibble: 90 x 13
##    well  well_row well_col sample_info sample_id strain OD    target_id    cq
##    &lt;chr&gt; &lt;fct&gt;    &lt;fct&gt;    &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;
##  1 E1    E        1        dAgr OD0.5… dAgr_OD0… dAgr   OD0.5 glyS      13.9 
##  2 E2    E        2        dAgr OD0.5… dAgr_OD0… dAgr   OD0.5 glyS      13.9 
##  3 E3    E        3        dAgr OD0.5… dAgr_OD0… dAgr   OD0.5 glyS      14   
##  4 F4    F        4        dAgr OD0.5… dAgr_OD0… dAgr   OD0.5 spoVG     13.6 
##  5 F5    F        5        dAgr OD0.5… dAgr_OD0… dAgr   OD0.5 spoVG     13.6 
##  6 F6    F        6        dAgr OD0.5… dAgr_OD0… dAgr   OD0.5 spoVG     13.5 
##  7 G7    G        7        dAgr OD0.5… dAgr_OD0… dAgr   OD0.5 5S         5.15
##  8 G8    G        8        dAgr OD0.5… dAgr_OD0… dAgr   OD0.5 5S         5.1 
##  9 G9    G        9        dAgr OD0.5… dAgr_OD0… dAgr   OD0.5 5S         5.12
## 10 E4    E        4        dAgr OD1.5… dAgr_OD1… dAgr   OD1.5 glyS      14.6 
## # … with 80 more rows, and 4 more variables: prep_type &lt;chr&gt;, ref_cq &lt;dbl&gt;,
## #   delta_cq &lt;dbl&gt;, rel_abund &lt;dbl&gt;</code></pre>
</div>
<div id="plot-normalized-data-all-reps" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-normalized-data-all-reps" class="anchor" aria-hidden="true"></a>Plot normalized data, all reps</h2>
<p>Similar to above, we plot all the replicates of the normalised data.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plate_norm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">target_id</span>, y <span class="op">=</span> <span class="va">delta_cq</span>, shape <span class="op">=</span> <span class="va">strain</span>, colour <span class="op">=</span> <span class="va">strain</span><span class="op">)</span>,
    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"delta Cq"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">OD</span>,ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="deltacq_96well_vignette_files/figure-html/plot_normalized-1.png" width="384"></p>
<p>This looks quite similar to the unnormalized data plot, except as expected the reference gene samples are all now deltaCq = 0, and there are small movements in the other points reflecting the normalization process.</p>
</div>
<div id="calculate-a-summary-value-for-each-sample-target-combination" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-a-summary-value-for-each-sample-target-combination" class="anchor" aria-hidden="true"></a>Calculate a summary value for each sample-target combination</h2>
<p>Having made normalized values, we use <code>group_by</code> and <code>summarize</code> from the <code>dplyr</code> package to calculate the median values of <code>delta_cq</code> and <code>rel_abund</code> for each sample. This makes a smaller table by collapsing 3 technical replicates into a single summary value for each <code>sample_id</code>-<code>target_id</code> combination.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plate_med</span> <span class="op">&lt;-</span> <span class="va">plate_norm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sample_info</span>, <span class="va">sample_id</span>, <span class="va">strain</span>, <span class="va">OD</span>, <span class="va">target_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>
    delta_cq  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">delta_cq</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    rel_abund <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">rel_abund</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">plate_med</span></code></pre></div>
<pre><code>## # A tibble: 30 x 7
## # Groups:   sample_info, sample_id, strain, OD [30]
##    sample_info      sample_id  strain OD    target_id delta_cq rel_abund
##    &lt;chr&gt;            &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;
##  1 dAgr OD0.5 5S    dAgr_OD0.5 dAgr   OD0.5 5S            0     1       
##  2 dAgr OD0.5 glyS  dAgr_OD0.5 dAgr   OD0.5 glyS          8.82  0.00221 
##  3 dAgr OD0.5 spoVG dAgr_OD0.5 dAgr   OD0.5 spoVG         8.46  0.00284 
##  4 dAgr OD1.5 5S    dAgr_OD1.5 dAgr   OD1.5 5S            0     1       
##  5 dAgr OD1.5 glyS  dAgr_OD1.5 dAgr   OD1.5 glyS          9.64  0.00125 
##  6 dAgr OD1.5 spoVG dAgr_OD1.5 dAgr   OD1.5 spoVG         7.74  0.00468 
##  7 dAgr OD3 5S      dAgr_OD3   dAgr   OD3   5S            0     1       
##  8 dAgr OD3 glyS    dAgr_OD3   dAgr   OD3   glyS         10.8   0.000577
##  9 dAgr OD3 spoVG   dAgr_OD3   dAgr   OD3   spoVG         7.93  0.00410 
## 10 dAgr OD6 5S      dAgr_OD6   dAgr   OD6   5S            0     1       
## # … with 20 more rows</code></pre>
<p>It can be easier to focus on a smaller subset of the data. Here we print just the data for a single target, <code>glyS</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plate_med</span>, <span class="va">target_id</span> <span class="op">==</span> <span class="st">"glyS"</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 7
## # Groups:   sample_info, sample_id, strain, OD [10]
##    sample_info     sample_id  strain OD    target_id delta_cq rel_abund
##    &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;
##  1 dAgr OD0.5 glyS dAgr_OD0.5 dAgr   OD0.5 glyS          8.82 0.00221  
##  2 dAgr OD1.5 glyS dAgr_OD1.5 dAgr   OD1.5 glyS          9.64 0.00125  
##  3 dAgr OD3 glyS   dAgr_OD3   dAgr   OD3   glyS         10.8  0.000577 
##  4 dAgr OD6 glyS   dAgr_OD6   dAgr   OD6   glyS         10.1  0.000930 
##  5 dAgr ODON glyS  dAgr_ODON  dAgr   ODON  glyS         13.6  0.0000822
##  6 WT OD0.5 glyS   WT_OD0.5   WT     OD0.5 glyS          8.99 0.00197  
##  7 WT OD1.5 glyS   WT_OD1.5   WT     OD1.5 glyS          9.71 0.00119  
##  8 WT OD3 glyS     WT_OD3     WT     OD3   glyS         10.7  0.000585 
##  9 WT OD6 glyS     WT_OD6     WT     OD6   glyS          8.46 0.00284  
## 10 WT ODON glyS    WT_ODON    WT     ODON  glyS         14.3  0.0000489</code></pre>
<p>This table confirms that <code>glyS</code> summary Cq values are similar for both strains at a given OD value, and higher at <code>ODON</code>.</p>
</div>
<div id="plot-delta-cq-for-each-od-separately-across-genes" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-delta-cq-for-each-od-separately-across-genes" class="anchor" aria-hidden="true"></a>Plot delta Cq for each OD separately across genes</h2>
<p>Here we plot the summarized delta Cq, which now has a single point for each <code>sample_id</code>-<code>target_id</code> combination (representing the summary of the three technical replicates). As above, we plot OD on a separate facet panel to emphasizes comparisons between target genes at the same OD. We exclude the reference target gene, 5S, because for that delta Cq is always zero.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plate_med</span>, <span class="va">target_id</span> <span class="op">!=</span> <span class="st">"5S"</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">target_id</span>, y <span class="op">=</span> <span class="va">delta_cq</span>, shape <span class="op">=</span> <span class="va">strain</span>, colour <span class="op">=</span> <span class="va">strain</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"delta Cq"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">OD</span>,ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="deltacq_96well_vignette_files/figure-html/plot_deltacq_vs_gene-1.png" width="384"></p>
</div>
<div id="plot-relative-abundance-for-each-od-separately-across-genes" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-relative-abundance-for-each-od-separately-across-genes" class="anchor" aria-hidden="true"></a>Plot relative abundance for each OD separately across genes</h2>
<p>The <code>calculate_deltacq_bysampleid</code> function also reports abundance relative to reference target, 5S rRNA. Precisely, this is . Now we plot the relative abundance, again with each OD on a separate facet panel, which emphasizes comparisons between target genes at the same OD.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plate_med</span>, <span class="va">target_id</span> <span class="op">!=</span> <span class="st">"5S"</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">target_id</span>, y <span class="op">=</span> <span class="va">rel_abund</span>, shape <span class="op">=</span> <span class="va">strain</span>, colour <span class="op">=</span> <span class="va">strain</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"RNA abundance relative to 5S"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">OD</span>,ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="deltacq_96well_vignette_files/figure-html/plot_relabund_vs_gene-1.png" width="384"></p>
</div>
<div id="plot-relative-abundance-for-each-gene-separately-across-ods" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-relative-abundance-for-each-gene-separately-across-ods" class="anchor" aria-hidden="true"></a>Plot relative abundance for each gene separately across ODs</h2>
<p>Here we plot the summarized relative abundance a different way: each target gene on a separate facet panel. This emphasizes changes in each target genes across ODs.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plate_med</span>, <span class="va">target_id</span> <span class="op">!=</span> <span class="st">"5S"</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">OD</span>, y <span class="op">=</span> <span class="va">rel_abund</span>, colour <span class="op">=</span> <span class="va">strain</span>, group <span class="op">=</span> <span class="va">strain</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">OD</span>, y <span class="op">=</span> <span class="va">rel_abund</span>, shape <span class="op">=</span> <span class="va">strain</span>, colour <span class="op">=</span> <span class="va">strain</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"RNA abundance relative to 5S"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">target_id</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="deltacq_96well_vignette_files/figure-html/plot_relabund_vs_OD-1.png" width="384"></p>
<p>We included this alternate plot to emphasize that the flexibility of ggplot enables trying of many different plotting strategies, to find one that is most appropriate for your data.</p>
</div>
</div>
<div id="doubly-normalized-data-delta-delta-cq" class="section level1">
<h1 class="hasAnchor">
<a href="#doubly-normalized-data-delta-delta-cq" class="anchor" aria-hidden="true"></a>Doubly normalized data: delta delta Cq</h1>
<div id="calculate-delta-delta-cq-against-a-chosen-reference-sample" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-delta-delta-cq-against-a-chosen-reference-sample" class="anchor" aria-hidden="true"></a>Calculate delta delta cq against a chosen reference sample</h2>
<p>Our goal here is to compare the normalized levels of glyS and spoVG in one growth condition to another growth condition, i.e. delta delta Cq (). This is an estimate of log2 fold change. In this case, the reference growth condition is the wild-type strain at OD 0.5.</p>
<p>This relies on a function in tidyqpcr, <code>calculate_deltadeltacq_bytargetid</code>.</p>
<ul>
<li>You provide data with <code>delta_cq</code> already calculated, and the name of the reference samples (i.e. <code>ref_sample_ids = "WT_OD0.5"</code>)</li>
<li>The function will calculate the median delta_cq of the reference samples separately for each target.</li>
<li>Then the function will subtract that value from the <code>delta_cq</code> for every other measured gene, again separately for each sample, adding a <code>deltadelta_cq</code> column to its output data</li>
<li>The function also calculates fold change of targets with respect to the reference samples, , adding a <code>fold_change</code> column to its output data.</li>
</ul>
<p>If you use <em>multiple</em> reference sample ids, the function will take the median across Cq values of <em>all</em> the reference target ids. For example, you might use multiple biological replicate samples of a single set of conditions. You can also ask the function to use a different summary, e.g. mean instead of median. See the help file <code><a href="../reference/calculate_deltadeltacq_bytargetid.html">?calculate_deltadeltacq_bytargetid</a></code> for more details.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plate_deltanorm</span> <span class="op">&lt;-</span> <span class="va">plate_norm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/calculate_deltadeltacq_bytargetid.html">calculate_deltadeltacq_bytargetid</a></span><span class="op">(</span>ref_sample_ids <span class="op">=</span> <span class="st">"WT_OD0.5"</span><span class="op">)</span>

<span class="va">plate_deltanorm_med</span> <span class="op">&lt;-</span> <span class="va">plate_deltanorm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sample_info</span>, <span class="va">sample_id</span>, <span class="va">strain</span>, <span class="va">OD</span>, <span class="va">target_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>
    deltadelta_cq  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">deltadelta_cq</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    fold_change    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">fold_change</span>,   na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">plate_deltanorm</span></code></pre></div>
<pre><code>## # A tibble: 90 x 16
##    well  well_row well_col sample_info sample_id strain OD    target_id    cq
##    &lt;chr&gt; &lt;fct&gt;    &lt;fct&gt;    &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;
##  1 G7    G        7        dAgr OD0.5… dAgr_OD0… dAgr   OD0.5 5S         5.15
##  2 G8    G        8        dAgr OD0.5… dAgr_OD0… dAgr   OD0.5 5S         5.1 
##  3 G9    G        9        dAgr OD0.5… dAgr_OD0… dAgr   OD0.5 5S         5.12
##  4 G10   G        10       dAgr OD1.5… dAgr_OD1… dAgr   OD1.5 5S         5.01
##  5 G11   G        11       dAgr OD1.5… dAgr_OD1… dAgr   OD1.5 5S         4.93
##  6 G12   G        12       dAgr OD1.5… dAgr_OD1… dAgr   OD1.5 5S         4.82
##  7 H1    H        1        dAgr OD3 5S dAgr_OD3  dAgr   OD3   5S         4.98
##  8 H2    H        2        dAgr OD3 5S dAgr_OD3  dAgr   OD3   5S         4.85
##  9 H3    H        3        dAgr OD3 5S dAgr_OD3  dAgr   OD3   5S         4.83
## 10 H4    H        4        dAgr OD6 5S dAgr_OD6  dAgr   OD6   5S         4.76
## # … with 80 more rows, and 7 more variables: prep_type &lt;chr&gt;, ref_cq &lt;dbl&gt;,
## #   delta_cq &lt;dbl&gt;, rel_abund &lt;dbl&gt;, ref_delta_cq &lt;dbl&gt;, deltadelta_cq &lt;dbl&gt;,
## #   fold_change &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plate_deltanorm_med</span></code></pre></div>
<pre><code>## # A tibble: 30 x 7
## # Groups:   sample_info, sample_id, strain, OD [30]
##    sample_info      sample_id  strain OD    target_id deltadelta_cq fold_change
##    &lt;chr&gt;            &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;             &lt;dbl&gt;       &lt;dbl&gt;
##  1 dAgr OD0.5 5S    dAgr_OD0.5 dAgr   OD0.5 5S                0           1    
##  2 dAgr OD0.5 glyS  dAgr_OD0.5 dAgr   OD0.5 glyS              0.170       1.13 
##  3 dAgr OD0.5 spoVG dAgr_OD0.5 dAgr   OD0.5 spoVG             0.170       1.13 
##  4 dAgr OD1.5 5S    dAgr_OD1.5 dAgr   OD1.5 5S                0           1    
##  5 dAgr OD1.5 glyS  dAgr_OD1.5 dAgr   OD1.5 glyS             -0.65        0.637
##  6 dAgr OD1.5 spoVG dAgr_OD1.5 dAgr   OD1.5 spoVG             0.890       1.85 
##  7 dAgr OD3 5S      dAgr_OD3   dAgr   OD3   5S                0           1    
##  8 dAgr OD3 glyS    dAgr_OD3   dAgr   OD3   glyS             -1.77        0.293
##  9 dAgr OD3 spoVG   dAgr_OD3   dAgr   OD3   spoVG             0.700       1.62 
## 10 dAgr OD6 5S      dAgr_OD6   dAgr   OD6   5S                0           1    
## # … with 20 more rows</code></pre>
<p>Note that in the summarised table <code>plate_deltanorm_med</code>, the reference target <code>5S</code> has <code>deltadelta_cq = 0</code> and <code>fold_change = 1</code> for all entries, because these values were used for normalization.</p>
</div>
<div id="plot-delta-delta-cq-log2-fold-change-for-each-target-gene" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-delta-delta-cq-log2-fold-change-for-each-target-gene" class="anchor" aria-hidden="true"></a>Plot delta delta Cq (log2-fold change) for each target gene</h2>
<p>Here, delta delta Cq is positive when a target is more highly detected in the relevant sample, compared to reference samples.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plate_deltanorm_med</span>, <span class="va">target_id</span> <span class="op">!=</span> <span class="st">"5S"</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">OD</span>, y <span class="op">=</span> <span class="va">deltadelta_cq</span>, colour <span class="op">=</span> <span class="va">strain</span>, group <span class="op">=</span> <span class="va">strain</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">OD</span>, y <span class="op">=</span> <span class="va">deltadelta_cq</span>, shape <span class="op">=</span> <span class="va">strain</span>, colour <span class="op">=</span> <span class="va">strain</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"delta delta Cq (log2 fold change)\n relative to WT OD 0.5"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">target_id</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="deltacq_96well_vignette_files/figure-html/plot_deltadeltacq_bytarget-1.png" width="408"></p>
</div>
<div id="plot-fold-change-for-each-target-gene" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-fold-change-for-each-target-gene" class="anchor" aria-hidden="true"></a>Plot fold change for each target gene</h2>
<p>Here we plot the fold change for each target gene, time-course style against OD.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plate_deltanorm_med</span>, <span class="va">target_id</span> <span class="op">!=</span> <span class="st">"5S"</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">OD</span>, y <span class="op">=</span> <span class="va">fold_change</span>, colour <span class="op">=</span> <span class="va">strain</span>, group <span class="op">=</span> <span class="va">strain</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">OD</span>, y <span class="op">=</span> <span class="va">fold_change</span>, shape <span class="op">=</span> <span class="va">strain</span>, colour <span class="op">=</span> <span class="va">strain</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"fold change relative to WT OD 0.5"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">target_id</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="deltacq_96well_vignette_files/figure-html/plot_foldchange_bytarget-1.png" width="384"></p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1 class="hasAnchor">
<a href="#conclusion" class="anchor" aria-hidden="true"></a>Conclusion</h1>
<p>In this vignette, you have learned the basic workflow for analysing Cq values from qPCR data:</p>
<ul>
<li>Create the <code>sample_id</code> column to uniquely identify each biological sample.</li>
<li>Calculate delta Cq and relative abundance using <code>calculate_deltacq_bysampleid</code>. This process normalizes target gene values to the values of one or more reference targets within each sample.</li>
<li>Calculate delta delta Cq and fold change using <code>calculate_deltadeltacq_bytargetid</code>. This process normalizes each target gene value for each sample to values of the same target in one or more reference samples.</li>
</ul>
</div>
<div id="notes-on-normalization-reference-targets-and-reference-samples" class="section level1">
<h1 class="hasAnchor">
<a href="#notes-on-normalization-reference-targets-and-reference-samples" class="anchor" aria-hidden="true"></a>Notes on normalization, reference targets, and reference samples</h1>
<p>In this section, we discuss the process of normalization and the choices of reference genes and samples in greater detail.</p>
<p>Normalization is a tool for making specific comparisons in specific experimental designs.</p>
<p>Tidyqpcr automatically implements one common approach, the <code>delta Cq</code> method, in <code>calculate_deltacq_bysampleid</code>. The user picks one or more reference targets, and then within each sample the function the median Cq of the reference targets from all other Cqs. The user can also choose a different summary function such as mean. If a single target id is chosen as reference, then it will be given summary delta Cq of zero; this might be sensible if there is external evidence that this target id genuinely has stable abundance in the conditions being tested. The <a href="https://academic.oup.com/clinchem/article/55/4/611/5631762" class="external-link">MIQE guidelines</a> are clear, and correct, that reliable quantification usually requires at least three carefully chosen reference targets.</p>
<p>The next step is to calculate the delta delta Cq, normalising each sample to a control sample. Specifically, <code>calculate_deltadeltacq_bytargetid</code> estimates the relative change in individual target id delta Cq values, compared to their values in one of more reference sample ids. If a single sample id were chosen as reference, then values in that sample will be given summary delta delta Cq of zero. Usually, an experiment would have multiple biological replicates, and so at least those replicates for a single condition would be chosen as reference sample ids.</p>
<p>However, the tidyverse and tidyqpcr have the flexibility to do normalization any way that your experiment requires. For example, for a time course with multiple strains and multiple timepoints, it might be important to compare delta Cq values against a reference strain at <em>each time point</em> instead of globally. These comparisons can be done with a little work using generic data-manipulation functions in the tidyverse, for example <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">dplyr::group_by</a></code>. If you have a specific question about a design that isn’t covered by the functions we have, you’re welcome to ask as an issue on [<a href="https://github.com/ewallace/tidyqpcr/issues/" class="external-link uri">https://github.com/ewallace/tidyqpcr/issues/</a>].</p>
<p>There is more information on the help pages for the functions, <code><a href="../reference/calculate_deltacq_bysampleid.html">?calculate_deltacq_bysampleid</a></code> and <code><a href="../reference/calculate_deltadeltacq_bytargetid.html">?calculate_deltadeltacq_bytargetid</a></code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Edward Wallace.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
