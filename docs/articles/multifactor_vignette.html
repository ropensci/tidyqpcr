<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multifactorial multi-plate qPCR analysis example • tidyqpcr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Multifactorial multi-plate qPCR analysis example">
<meta property="og:description" content="tidyqpcr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidyqpcr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/calibration_vignette.html">Primers and probes calibration vignette</a>
    </li>
    <li>
      <a href="../articles/deltacq_96well_vignette.html">Delta Cq 96-well plate qPCR analysis example</a>
    </li>
    <li>
      <a href="../articles/multifactor_vignette.html">Multifactorial multi-plate qPCR analysis example</a>
    </li>
    <li>
      <a href="../articles/platesetup_vignette.html">Introduction to designing an experiment and setting up a plate plan in tidyqpcr</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ewallace/tidyqpcr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Multifactorial multi-plate qPCR analysis
example</h1>
                        <h4 data-toc-skip class="author">Edward
Wallace</h4>
            
            <h4 data-toc-skip class="date">April 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ewallace/tidyqpcr/blob/HEAD/vignettes/multifactor_vignette.Rmd" class="external-link"><code>vignettes/multifactor_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>multifactor_vignette.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="summary-an-example-multifactorial-qpcr-experiment-">Summary: an example multifactorial qPCR experiment.<a class="anchor" aria-label="anchor" href="#summary-an-example-multifactorial-qpcr-experiment-"></a>
</h2>
<p>This vignette shows how to use tidyqpcr functions to normalize and
plot data from multifactorial experiments: many primer sets, many
conditions, two plates. This vignette is a more advanced example with
complex data.</p>
<p>This is real RT-qPCR data by Edward Wallace in June 2018, testing the
effect of heat shock and transcription-targeting drugs in
<em>Saccharomyces cerevisiae</em> yeast.</p>
<div class="section level3">
<h3 id="pilot-experiment">Pilot experiment<a class="anchor" aria-label="anchor" href="#pilot-experiment"></a>
</h3>
<p>Do standard transcriptional inhibitors phenanthroline and thiolutin
block the transcriptional heat shock response in yeast? This is a
genuine question because some papers that argue that phenanthroline and
thiolutin <strong>induce</strong> the transcriptional heat shock
response.</p>
<p>Measure 16 primer sets: HOR7, HSP12, HSP26, HSP78, HSP104, RTC3,
SSA4, PGK1, ALG9, HHT2, HTB2, RPS3, RPS13, RPS15, RPS30A, RPL39.</p>
<p>Test 6 conditions. That’s 3 transcriptional inhibitors (no drug
control, 150ug/mL 1,10-phenanthroline, 3ug/mL thiolutin) in each of 2
conditions (- heat shock control, + heat shock 42C 10min), 2 biol reps
each:</p>
<pre><code>- *C-* Control -heat
- *P-* Phenanthroline -heat
- *T-* Thiolutin -heat
- *C+* Control +heat
- *P+* Phenanthroline +heat
- *T+* Thiolutin +heat</code></pre>
</div>
<div class="section level3">
<h3 id="setup-knitr-options-and-load-packages">Setup knitr options and load packages<a class="anchor" aria-label="anchor" href="#setup-knitr-options-and-load-packages"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># knitr options for report generation</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>
  warning <span class="op">=</span> <span class="cn">FALSE</span>, message <span class="op">=</span> <span class="cn">FALSE</span>, echo <span class="op">=</span> <span class="cn">TRUE</span>, cache <span class="op">=</span> <span class="cn">FALSE</span>,
  results <span class="op">=</span> <span class="st">"show"</span>
<span class="op">)</span>

<span class="co"># Load packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ewallace/tidyqpcr" class="external-link">tidyqpcr</a></span><span class="op">)</span>

<span class="co"># set default theme for graphics</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">%+replace%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>
    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="label-and-plan-plates">Label and plan plates<a class="anchor" aria-label="anchor" href="#label-and-plan-plates"></a>
</h3>
<p>Reverse transcription by random primers mixed with oligo-dT.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># list target_ids of primer sets</span>
<span class="va">target_id_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
  <span class="st">"HOR7"</span>, <span class="st">"HSP12"</span>, <span class="st">"HSP26"</span>, <span class="st">"HSP78"</span>,
  <span class="st">"HSP104"</span>, <span class="st">"RTC3"</span>, <span class="st">"SSA4"</span>, <span class="st">"PGK1"</span>,
  <span class="st">"ALG9"</span>, <span class="st">" HHT2"</span>, <span class="st">"HTB2"</span>, <span class="st">"RPS3"</span>,
  <span class="st">"RPS13"</span>, <span class="st">"RPS15"</span>, <span class="st">"RPS30A"</span>, <span class="st">"RPL39"</span>
<span class="op">)</span>

<span class="va">rowkey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>
  well_row <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span>,
  target_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">target_id_levels</span>, levels <span class="op">=</span> <span class="va">target_id_levels</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># Set up experimental samples</span>
<span class="va">heat_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-"</span>, <span class="st">"+"</span><span class="op">)</span>
<span class="va">heat_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">heat_levels</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, levels <span class="op">=</span> <span class="va">heat_levels</span><span class="op">)</span>
<span class="va">drug_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"P"</span>, <span class="st">"T"</span><span class="op">)</span>
<span class="va">drug_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">drug_levels</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, levels <span class="op">=</span> <span class="va">drug_levels</span><span class="op">)</span>
<span class="va">condition_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">drug_levels</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">heat_levels</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="va">condition_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">condition_levels</span>, levels <span class="op">=</span> <span class="va">condition_levels</span><span class="op">)</span>

<span class="va">colkey</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_colkey_6_in_24.html">create_colkey_6_in_24</a></span><span class="op">(</span>
  heat <span class="op">=</span> <span class="va">heat_values</span>,
  drug <span class="op">=</span> <span class="va">drug_values</span>,
  condition <span class="op">=</span> <span class="va">condition_values</span>
<span class="op">)</span>

<span class="va">plateplan</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/label_plate_rowcol.html">label_plate_rowcol</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/create_blank_plate.html">create_blank_plate</a></span><span class="op">(</span>well_row <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span>, well_col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span>,
    <span class="va">rowkey</span>, <span class="va">colkey</span>
  <span class="op">)</span></code></pre></div>
<p>Display the plate plan using display_plate_qpcr.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/display_plate_qpcr.html">display_plate_qpcr</a></span><span class="op">(</span><span class="va">plateplan</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sample_id <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="multifactor_vignette_files/figure-html/display_plates-1.png" width="960"></p>
<p>Note that display_plate_qpcr requires a column called
<code>sample_id</code>, which here we had to make from the
<code>condition</code> variable using
<code>mutate(sample_id=condition)</code>. The reason for doing this is
that we have replicate samples of the same condition in different
plates, and so we assign the unique sample name for each replicate after
loading the plates together using <code>unite</code> in the next code
chunk.</p>
</div>
<div class="section level3">
<h3 id="load-and-summarize-data">Load and summarize data<a class="anchor" aria-label="anchor" href="#load-and-summarize-data"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># read my plate data, one at a time, with biol_rep and plate number</span>

<span class="co"># NOTE: system.file() accesses data from this R package</span>
<span class="co"># To use your own data, remove the call to system.file(),</span>
<span class="co"># instead pass your data's filename to read_lightcycler_1colour_cq()</span>
<span class="co"># or to another relevant read_ function</span>

<span class="va">file_path_cq_plate1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,
              <span class="st">"Edward_qPCR_TxnInhibitors_HS_2018-06-15_plate1_Cq.txt.gz"</span>,
              package <span class="op">=</span> <span class="st">"tidyqpcr"</span><span class="op">)</span>

<span class="va">plate1</span> <span class="op">&lt;-</span> <span class="va">file_path_cq_plate1</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/read_lightcycler_1colour_cq.html">read_lightcycler_1colour_cq</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">plateplan</span>, by <span class="op">=</span> <span class="st">"well"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>biol_rep <span class="op">=</span> <span class="st">"1"</span>, plate <span class="op">=</span> <span class="st">"1"</span><span class="op">)</span>

<span class="va">file_path_cq_plate2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,
              <span class="st">"Edward_qPCR_TxnInhibitors_HS_2018-06-15_plate2_Cq.txt.gz"</span>,
              package <span class="op">=</span> <span class="st">"tidyqpcr"</span><span class="op">)</span>

<span class="va">plate2</span> <span class="op">&lt;-</span> <span class="va">file_path_cq_plate2</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/read_lightcycler_1colour_cq.html">read_lightcycler_1colour_cq</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">plateplan</span>, by <span class="op">=</span> <span class="st">"well"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>biol_rep <span class="op">=</span> <span class="st">"2"</span>, plate <span class="op">=</span> <span class="st">"2"</span><span class="op">)</span>

<span class="co"># combine data from both plates into a single data frame</span>
<span class="va">plates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">plate1</span>, <span class="va">plate2</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html" class="external-link">unite</a></span><span class="op">(</span><span class="va">sample_id</span>, <span class="va">condition</span>, <span class="va">biol_rep</span>, sep <span class="op">=</span> <span class="st">""</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">plates</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##  include            color           well           sample_info       </span>
<span class="co">##  Mode:logical   Min.   :  255   Length:768         Length:768        </span>
<span class="co">##  TRUE:768       1st Qu.:  255   Class :character   Class :character  </span>
<span class="co">##                 Median :  255   Mode  :character   Mode  :character  </span>
<span class="co">##                 Mean   : 9738                                        </span>
<span class="co">##                 3rd Qu.:  255                                        </span>
<span class="co">##                 Max.   :65280                                        </span>
<span class="co">##                                                                      </span>
<span class="co">##        cq        concentration    standard  status           well_row  </span>
<span class="co">##  Min.   : 3.11   Min.   : NA   Min.   :0   Mode:logical   A      : 48  </span>
<span class="co">##  1st Qu.:15.92   1st Qu.: NA   1st Qu.:0   NA's:768       B      : 48  </span>
<span class="co">##  Median :18.12   Median : NA   Median :0                  C      : 48  </span>
<span class="co">##  Mean   :19.86   Mean   :NaN   Mean   :0                  D      : 48  </span>
<span class="co">##  3rd Qu.:21.19   3rd Qu.: NA   3rd Qu.:0                  E      : 48  </span>
<span class="co">##  Max.   :37.51   Max.   : NA   Max.   :0                  F      : 48  </span>
<span class="co">##  NA's   :112     NA's   :768                              (Other):480  </span>
<span class="co">##     well_col   prep_type tech_rep heat    drug     sample_id         condition</span>
<span class="co">##  1      : 32   +RT:576   1:384    -:384   C:256   Length:768         C-:128   </span>
<span class="co">##  2      : 32   -RT:192   2:192    +:384   P:256   Class :character   P-:128   </span>
<span class="co">##  3      : 32             3:192            T:256   Mode  :character   T-:128   </span>
<span class="co">##  4      : 32                                                         C+:128   </span>
<span class="co">##  5      : 32                                                         P+:128   </span>
<span class="co">##  6      : 32                                                         T+:128   </span>
<span class="co">##  (Other):576                                                                  </span>
<span class="co">##    target_id     biol_rep            plate          </span>
<span class="co">##  HOR7   : 48   Length:768         Length:768        </span>
<span class="co">##  HSP12  : 48   Class :character   Class :character  </span>
<span class="co">##  HSP26  : 48   Mode  :character   Mode  :character  </span>
<span class="co">##  HSP78  : 48                                        </span>
<span class="co">##  HSP104 : 48                                        </span>
<span class="co">##  RTC3   : 48                                        </span>
<span class="co">##  (Other):480</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="plot-unnormalized-data">Plot unnormalized data<a class="anchor" aria-label="anchor" href="#plot-unnormalized-data"></a>
</h2>
<div class="section level3">
<h3 id="rt-controls-are-low">-RT controls are low<a class="anchor" aria-label="anchor" href="#rt-controls-are-low"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plates</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">target_id</span>, y <span class="op">=</span> <span class="va">cq</span>, shape <span class="op">=</span> <span class="va">condition</span>, colour <span class="op">=</span> <span class="va">condition</span><span class="op">)</span>,
    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"Cycle count to threshold"</span>,
    title <span class="op">=</span> <span class="st">"All reps, unnormalized"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span><span class="op">:</span><span class="fl">18</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">biol_rep</span> <span class="op">~</span> <span class="va">prep_type</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>
    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,
    panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>
      fill <span class="op">=</span> <span class="cn">NA</span>, linetype <span class="op">=</span> <span class="fl">1</span>,
      colour <span class="op">=</span> <span class="st">"grey50"</span>, size <span class="op">=</span> <span class="fl">0.5</span>
    <span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p><img src="multifactor_vignette_files/figure-html/plot_unnormalized-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="normalize-cq-to-pgk1-within-sample-only">Normalize Cq to PGK1, within Sample only<a class="anchor" aria-label="anchor" href="#normalize-cq-to-pgk1-within-sample-only"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">platesnorm</span> <span class="op">&lt;-</span> <span class="va">plates</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">prep_type</span> <span class="op">==</span> <span class="st">"+RT"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/calculate_deltacq_bysampleid.html">calculate_deltacq_bysampleid</a></span><span class="op">(</span>ref_target_ids <span class="op">=</span> <span class="st">"PGK1"</span><span class="op">)</span>

<span class="va">platesmed</span> <span class="op">&lt;-</span> <span class="va">platesnorm</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sample_id</span>, <span class="va">condition</span>, <span class="va">biol_rep</span>, <span class="va">heat</span>, <span class="va">drug</span>, <span class="va">target_id</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>
    delta_cq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">delta_cq</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    rel_abund <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">rel_abund</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="op">)</span>

<span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">platesmed</span>, <span class="va">target_id</span> <span class="op">==</span> <span class="st">"HSP26"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 12 × 8</span></span>
<span class="co">## <span style="color: #949494;"># Groups:   sample_id, condition, biol_rep, heat, drug [12]</span></span>
<span class="co">##    sample_id condition biol_rep heat  drug  target_id delta_cq rel_abund</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> C-1       C-        1        -     C     HSP26       0.070<span style="text-decoration: underline;">0</span>    0.953 </span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> C-2       C-        2        -     C     HSP26       1.02      0.493 </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> C+1       C+        1        +     C     HSP26       0.98      0.507 </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> C+2       C+        2        +     C     HSP26       1.58      0.334 </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> P-1       P-        1        -     P     HSP26       2.53      0.173 </span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> P-2       P-        2        -     P     HSP26       3.8       0.071<span style="text-decoration: underline;">8</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> P+1       P+        1        +     P     HSP26       1.60      0.330 </span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> P+2       P+        2        +     P     HSP26       1.60      0.330 </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> T-1       T-        1        -     T     HSP26       1.44      0.369 </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> T-2       T-        2        -     T     HSP26       3.02      0.123 </span>
<span class="co">## <span style="color: #BCBCBC;">11</span> T+1       T+        1        +     T     HSP26       1.19      0.441 </span>
<span class="co">## <span style="color: #BCBCBC;">12</span> T+2       T+        2        +     T     HSP26       2.06      0.240</span></code></pre>
</div>
<div class="section level3">
<h3 id="plot-normalized-data-all-reps">Plot normalized data, all reps<a class="anchor" aria-label="anchor" href="#plot-normalized-data-all-reps"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">platesnorm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">target_id</span>,
                 y <span class="op">=</span> <span class="va">delta_cq</span>,
                 shape <span class="op">=</span> <span class="va">condition</span>,
                 colour <span class="op">=</span> <span class="va">condition</span><span class="op">)</span>,
    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Cq relative to PGK1"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span><span class="op">:</span><span class="fl">18</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">biol_rep</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>
    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,
    panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>
      fill <span class="op">=</span> <span class="cn">NA</span>, linetype <span class="op">=</span> <span class="fl">1</span>,
      colour <span class="op">=</span> <span class="st">"grey50"</span>, size <span class="op">=</span> <span class="fl">0.5</span>
    <span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p><img src="multifactor_vignette_files/figure-html/plot_normalized-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="plot-normalized-data-summarized-vs-target_id">Plot normalized data, summarized vs target_id<a class="anchor" aria-label="anchor" href="#plot-normalized-data-summarized-vs-target_id"></a>
</h3>
<div class="section level4">
<h4 id="all-on-same-axes">All on same axes<a class="anchor" aria-label="anchor" href="#all-on-same-axes"></a>
</h4>
<p>This plot shows all the summarized data on the same axes, but it is
hard to pick out the different conditions by eye.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">platesmed</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">target_id</span>,
                 y <span class="op">=</span> <span class="va">rel_abund</span>,
                 shape <span class="op">=</span> <span class="va">biol_rep</span>,
                 colour <span class="op">=</span> <span class="va">condition</span><span class="op">)</span>,
    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span><span class="op">:</span><span class="fl">18</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="st">"mRNA relative detection"</span>,
                labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="multifactor_vignette_files/figure-html/plot_normalizedsummarized1-1.png" width="384"></p>
</div>
<div class="section level4">
<h4 id="faceted-by-drug-treatment">Faceted by drug treatment<a class="anchor" aria-label="anchor" href="#faceted-by-drug-treatment"></a>
</h4>
<p>This plot shows all the summarized data “faceted” on different axes
for different drug treatments. It highlights that, for example, SSA4
detection increases in response to heat in all drug treatments.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">platesmed</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">target_id</span>, y <span class="op">=</span> <span class="va">rel_abund</span>, shape <span class="op">=</span> <span class="va">biol_rep</span>, colour <span class="op">=</span> <span class="va">heat</span><span class="op">)</span>,
    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">drug</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-"</span> <span class="op">=</span> <span class="st">"grey50"</span>, <span class="st">"+"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="st">"mRNA relative detection"</span>,
                labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="multifactor_vignette_files/figure-html/plot_normalizedsummarizedbyheat-1.png" width="864"></p>
</div>
<div class="section level4">
<h4 id="faceted-by-heat-shock-condition">Faceted by heat shock condition<a class="anchor" aria-label="anchor" href="#faceted-by-heat-shock-condition"></a>
</h4>
<p>By contrast, this plot shows all the summarized data “faceted” on
different axes for different conditions. This shows that there is no
clear response to the drug treatments in either condition.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">platesmed</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">target_id</span>, y <span class="op">=</span> <span class="va">rel_abund</span>, shape <span class="op">=</span> <span class="va">biol_rep</span>, colour <span class="op">=</span> <span class="va">drug</span><span class="op">)</span>,
    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">heat</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="st">"mRNA relative detection"</span>,
                labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="multifactor_vignette_files/figure-html/plot_normalizedsummarizedbydrug-1.png" width="864"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="melt-and-amplification-curves">Melt and Amplification Curves<a class="anchor" aria-label="anchor" href="#melt-and-amplification-curves"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># NOTE: system.file() accesses data from this R package</span>
<span class="co"># To use your own data, remove the call to system.file(),</span>
<span class="co"># instead pass your data's filename to read_lightcycler_1colour_cq()</span>
<span class="co"># or to another relevant read_ function</span>

<span class="va">file_path_raw_plate1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Edward_qPCR_TxnInhibitors_HS_2018-06-15_plate1.txt.gz"</span>,
              package <span class="op">=</span> <span class="st">"tidyqpcr"</span><span class="op">)</span>

<span class="va">plate1curve</span> <span class="op">&lt;-</span> <span class="va">file_path_raw_plate1</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="../reference/read_lightcycler_1colour_raw.html">read_lightcycler_1colour_raw</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="../reference/debaseline.html">debaseline</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">plateplan</span>, by <span class="op">=</span> <span class="st">"well"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>biol_rep <span class="op">=</span> <span class="fl">1</span>, plate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">file_path_raw_plate2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Edward_qPCR_TxnInhibitors_HS_2018-06-15_plate2.txt.gz"</span>,
              package <span class="op">=</span> <span class="st">"tidyqpcr"</span><span class="op">)</span>

<span class="va">plate2curve</span> <span class="op">&lt;-</span> <span class="va">file_path_raw_plate2</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="../reference/read_lightcycler_1colour_raw.html">read_lightcycler_1colour_raw</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="../reference/debaseline.html">debaseline</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">plateplan</span>, by <span class="op">=</span> <span class="st">"well"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>biol_rep <span class="op">=</span> <span class="fl">2</span>, plate <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="va">platesamp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">plate1curve</span>, <span class="va">plate2curve</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">program_no</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>

<span class="va">platesmelt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">plate1curve</span>, <span class="va">plate2curve</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">program_no</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/calculate_drdt_plate.html">calculate_drdt_plate</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">temperature</span> <span class="op">&gt;=</span> <span class="fl">61</span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="melt-curves-biol_rep-1">Melt Curves, biol_rep 1<a class="anchor" aria-label="anchor" href="#melt-curves-biol_rep-1"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesmelt</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">biol_rep</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature</span>, y <span class="op">=</span> <span class="va">dRdT</span>, linetype <span class="op">=</span> <span class="va">prep_type</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">~</span> <span class="va">target_id</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-RT"</span> <span class="op">=</span> <span class="st">"dashed"</span>, <span class="st">"+RT"</span> <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>,
                     minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Melt curves, biol. rep. 1, tech. rep. 1"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="multifactor_vignette_files/figure-html/plotmelt_rep1-1.png" width="1152"></p>
</div>
<div class="section level3">
<h3 id="melt-curves-biol_rep-2">Melt Curves, biol_rep 2<a class="anchor" aria-label="anchor" href="#melt-curves-biol_rep-2"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesmelt</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">biol_rep</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature</span>, y <span class="op">=</span> <span class="va">dRdT</span>, linetype <span class="op">=</span> <span class="va">prep_type</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">~</span> <span class="va">target_id</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-RT"</span> <span class="op">=</span> <span class="st">"dashed"</span>, <span class="st">"+RT"</span> <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>,
                     minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Melt curves, biol. rep. 2, tech. rep. 1"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="multifactor_vignette_files/figure-html/plotmelt_rep2-1.png" width="1152"></p>
</div>
<div class="section level3">
<h3 id="amp-curves-biol_rep-1">Amp Curves, biol_rep 1<a class="anchor" aria-label="anchor" href="#amp-curves-biol_rep-1"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesamp</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">biol_rep</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cycle</span>, y <span class="op">=</span> <span class="va">fluor_signal</span>, linetype <span class="op">=</span> <span class="va">prep_type</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">~</span> <span class="va">target_id</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-RT"</span> <span class="op">=</span> <span class="st">"dashed"</span>, <span class="st">"+RT"</span> <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Amp. curves, biol. rep. 1, tech. rep. 1"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="multifactor_vignette_files/figure-html/plotamp_rep1-1.png" width="1152"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesamp</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">biol_rep</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cycle</span>, y <span class="op">=</span> <span class="va">fluor_signal</span>, linetype <span class="op">=</span> <span class="va">prep_type</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">~</span> <span class="va">target_id</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-RT"</span> <span class="op">=</span> <span class="st">"dashed"</span>, <span class="st">"+RT"</span> <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Amp. curves, biol. rep. 2, tech. rep. 1"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="multifactor_vignette_files/figure-html/plotamp_rep2-1.png" width="1152"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Edward Wallace.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
