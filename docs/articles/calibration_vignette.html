<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Primers and probes calibration vignette • tidyqpcr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Primers and probes calibration vignette">
<meta property="og:description" content="tidyqpcr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidyqpcr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/calibration_vignette.html">Primers and probes calibration vignette</a>
    </li>
    <li>
      <a href="../articles/deltacq_96well_vignette.html">Delta Cq 96-well plate qPCR analysis example</a>
    </li>
    <li>
      <a href="../articles/multifactor_vignette.html">Multifactorial multi-plate qPCR analysis example</a>
    </li>
    <li>
      <a href="../articles/platesetup_vignette.html">Introduction to designing an experiment and setting up a plate plan in tidyqpcr</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ewallace/tidyqpcr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Primers and probes calibration vignette</h1>
                        <h4 data-toc-skip class="author">Edward
Wallace</h4>
            
            <h4 data-toc-skip class="date">April 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ewallace/tidyqpcr/blob/HEAD/vignettes/calibration_vignette.Rmd" class="external-link"><code>vignettes/calibration_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>calibration_vignette.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="summary-calibrating-primer-sets-from-a-real-experimental-test">Summary: calibrating primer sets from a real experimental test<a class="anchor" aria-label="anchor" href="#summary-calibrating-primer-sets-from-a-real-experimental-test"></a>
</h2>
<p>This vignette shows how to use tidyqpcr functions to calibrate qPCR
probes.</p>
<p>This is real qPCR data by Edward Wallace in Feb 2019, testing new
RT-qPCR primer sets against <em>S. cerevisiae</em> genes. We took
exponential-phase total RNA previously extracted by Jamie Auxillos.</p>
<p>We tested 2-3 primer sets each for 7 genes:</p>
<ul>
<li>ECM38/YLR299W (3 primer sets)</li>
<li>FET5/YFL041W (3 primer sets)</li>
<li>GPT2/YKR067W</li>
<li>ILV5/YLR355C</li>
<li>NRD1/YNL251C</li>
<li>RDL1/YOR285W</li>
<li>TFS1/YLR178C</li>
</ul>
<p>We started with two biological replicate RNA samples, treated with
DNase and then split for a test sample with reverse transcriptase (RT)
and negative control without reverse transcriptase (-RT). We also took a
no template (NT) negative control. For each RT reaction we do serial 5x
dilutions down to 125x to form a quantitative calibration curve.</p>
<p>The data were measured on a Roche LC480 instrument in a single
384-well plate. Quantification was performed in the Roche LightCycler
software prior to exporting the data.</p>
<div class="section level3">
<h3 id="setup-knitr-options-and-load-packages">Setup knitr options and load packages<a class="anchor" aria-label="anchor" href="#setup-knitr-options-and-load-packages"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># knitr options for report generation</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>
  warning <span class="op">=</span> <span class="cn">FALSE</span>, message <span class="op">=</span> <span class="cn">FALSE</span>, echo <span class="op">=</span> <span class="cn">TRUE</span>, cache <span class="op">=</span> <span class="cn">FALSE</span>,
  results <span class="op">=</span> <span class="st">"show"</span>
<span class="op">)</span>

<span class="co"># Load packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ewallace/tidyqpcr" class="external-link">tidyqpcr</a></span><span class="op">)</span>

<span class="co"># set default theme for graphics</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">%+replace%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>
    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
    panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="set-up-experiment">Set up experiment<a class="anchor" aria-label="anchor" href="#set-up-experiment"></a>
</h2>
<div class="section level3">
<h3 id="describe-which-primer-set-we-put-in-which-well-using-a-row-key">Describe which primer set we put in which well using a row key<a class="anchor" aria-label="anchor" href="#describe-which-primer-set-we-put-in-which-well-using-a-row-key"></a>
</h3>
<p>In this experiment, each primer set was in a different row of the
384-well plate. We describe this by creating a row key, a data frame
describing the rows of the plate, the primer sets, and the genes that
they detect.</p>
<p>We refer to each primer set as a <code>target_id</code>, because each
primer set has a different target amplicon, on a different location in a
gene. tidyqpcr insists on having a variable called
<code>target_id</code> that uniquely identifies each different target
that you detect.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Names of target genes</span>
<span class="va">gene_name_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ECM38"</span>, <span class="st">"FET5"</span>, <span class="st">"GPT2"</span>, <span class="st">"ILV5"</span>, <span class="st">"NRD1"</span>, <span class="st">"RDL1"</span>, <span class="st">"TFS1"</span><span class="op">)</span>
<span class="co"># ORF ids of target genes</span>
<span class="va">target_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"YLR299W"</span>, <span class="st">"YFL041W"</span>, <span class="st">"YKR067W"</span>, <span class="st">"YLR355C"</span>,
                   <span class="st">"YNL251C"</span>, <span class="st">"YOR285W"</span>, <span class="st">"YLR178C"</span><span class="op">)</span>
<span class="co"># Repeats of gene names to account for testing multiple primer sets</span>
<span class="va">gene_name_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">gene_name_levels</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
                      <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">gene_name_levels</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co"># id numbers of multiple probesets (reflecting IDs as ordered)</span>
<span class="va">target_id_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">gene_name_values</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,
  sep <span class="op">=</span> <span class="st">"_"</span>
<span class="op">)</span>


<span class="va">rowkey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>
  well_row <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span>,
  gene_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">gene_name_values</span>, levels <span class="op">=</span> <span class="va">gene_name_levels</span><span class="op">)</span>,
  target_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">target_id_levels</span>, levels <span class="op">=</span> <span class="va">target_id_levels</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rowkey</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 16 × 3</span></span>
<span class="co">##    well_row gene_name target_id</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    </span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> A        ECM38     ECM38_1  </span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> B        ECM38     ECM38_2  </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> C        ECM38     ECM38_3  </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> D        FET5      FET5_1   </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> E        FET5      FET5_3   </span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> F        FET5      FET5_4   </span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> G        GPT2      GPT2_1   </span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> H        GPT2      GPT2_4   </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> I        ILV5      ILV5_1   </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> J        ILV5      ILV5_4   </span>
<span class="co">## <span style="color: #BCBCBC;">11</span> K        NRD1      NRD1_1   </span>
<span class="co">## <span style="color: #BCBCBC;">12</span> L        NRD1      NRD1_2   </span>
<span class="co">## <span style="color: #BCBCBC;">13</span> M        RDL1      RDL1_4   </span>
<span class="co">## <span style="color: #BCBCBC;">14</span> N        RDL1      RDL1_5   </span>
<span class="co">## <span style="color: #BCBCBC;">15</span> O        TFS1      TFS1_1   </span>
<span class="co">## <span style="color: #BCBCBC;">16</span> P        TFS1      TFS1_5</span></code></pre>
</div>
<div class="section level3">
<h3 id="combine-the-row-key-describing-primer-sets-with-column-key-describing-on-samples-and-dilutions-">Combine the row key describing primer sets with column key
describing on samples and dilutions.<a class="anchor" aria-label="anchor" href="#combine-the-row-key-describing-primer-sets-with-column-key-describing-on-samples-and-dilutions-"></a>
</h3>
<p>We use a default design built in to tidyqpcr,
<code>create_colkey_4diln_2ctrl_in_24</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plate1plan</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/label_plate_rowcol.html">label_plate_rowcol</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/create_blank_plate.html">create_blank_plate</a></span><span class="op">(</span><span class="op">)</span>,
    <span class="va">rowkey</span>,
    <span class="fu"><a href="../reference/create_colkey_4diln_2ctrl_in_24.html">create_colkey_4diln_2ctrl_in_24</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sample_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">biol_rep</span>, <span class="va">dilution_nice</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="spot-check-the-plate-plan">Spot-check the plate plan<a class="anchor" aria-label="anchor" href="#spot-check-the-plate-plan"></a>
</h3>
<p>Checks that for selected technical replicate/probe/dilution
combinations, the plate contains the right number of replicates.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plate1plan</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"1"</span>,
         <span class="va">target_id</span> <span class="op">==</span> <span class="va">target_id_levels</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
         <span class="va">dilution_nice</span> <span class="op">==</span> <span class="st">"1x"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 2 × 11</span></span>
<span class="co">##   well  well_row well_col dilution dilution_nice prep_type biol_rep tech_rep</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   </span>
<span class="co">## <span style="color: #BCBCBC;">1</span> A1    A        1               1 1x            +RT       A        1       </span>
<span class="co">## <span style="color: #BCBCBC;">2</span> A13   A        13              1 1x            +RT       B        1       </span>
<span class="co">## <span style="color: #949494;"># … with 3 more variables: gene_name &lt;fct&gt;, target_id &lt;fct&gt;, sample_id &lt;chr&gt;</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plate1plan</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"2"</span>,
         <span class="va">target_id</span> <span class="op">==</span> <span class="va">target_id_levels</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 12 × 11</span></span>
<span class="co">##    well  well_row well_col dilution dilution_nice prep_type biol_rep tech_rep</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   </span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> D7    D        7           1     1x            +RT       A        2       </span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> D8    D        8           0.2   5x            +RT       A        2       </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> D9    D        9           0.04  25x           +RT       A        2       </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> D10   D        10          0.008 125x          +RT       A        2       </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> D11   D        11          1     -RT           -RT       A        2       </span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> D12   D        12          1     NT            NT        A        2       </span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> D19   D        19          1     1x            +RT       B        2       </span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> D20   D        20          0.2   5x            +RT       B        2       </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> D21   D        21          0.04  25x           +RT       B        2       </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> D22   D        22          0.008 125x          +RT       B        2       </span>
<span class="co">## <span style="color: #BCBCBC;">11</span> D23   D        23          1     -RT           -RT       B        2       </span>
<span class="co">## <span style="color: #BCBCBC;">12</span> D24   D        24          1     NT            NT        B        2       </span>
<span class="co">## <span style="color: #949494;"># … with 3 more variables: gene_name &lt;fct&gt;, target_id &lt;fct&gt;, sample_id &lt;chr&gt;</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="display-the-plate-plan">Display the plate plan<a class="anchor" aria-label="anchor" href="#display-the-plate-plan"></a>
</h3>
<p>This can be printed out to facilitate loading the plate
correctly.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/display_plate_qpcr.html">display_plate_qpcr</a></span><span class="op">(</span><span class="va">plate1plan</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/display_plates-1.png" width="1152"></p>
</div>
</div>
<div class="section level2">
<h2 id="analyse-cq-quantification-cycle-count-data">Analyse Cq (quantification cycle count) data<a class="anchor" aria-label="anchor" href="#analyse-cq-quantification-cycle-count-data"></a>
</h2>
<div class="section level3">
<h3 id="load-and-summarize-data">Load and summarize data<a class="anchor" aria-label="anchor" href="#load-and-summarize-data"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># NOTE: system.file() accesses data from this R package</span>
<span class="co"># To use your own data, remove the call to system.file(),</span>
<span class="co"># instead pass your data's filename to read_lightcycler_1colour_cq()</span>
<span class="co"># or to another relevant read_ function</span>
<span class="va">file_path_cq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,
              <span class="st">"Edward_qPCR_Nrd1_calibration_2019-02-02_Cq.txt.gz"</span>,
              package <span class="op">=</span> <span class="st">"tidyqpcr"</span><span class="op">)</span>

<span class="va">plates</span> <span class="op">&lt;-</span> 
  <span class="va">file_path_cq</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/read_lightcycler_1colour_cq.html">read_lightcycler_1colour_cq</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">right_join</a></span><span class="op">(</span><span class="va">plate1plan</span>, by <span class="op">=</span> <span class="st">"well"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plates</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 384 × 18</span></span>
<span class="co">##    include color well  sample_info    cq concentration standard status well_row</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   </span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> TRUE      255 A1    Sample 1     22.8            <span style="color: #BB0000;">NA</span>        0 <span style="color: #BB0000;">NA</span>     A       </span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> TRUE      255 A2    Sample 2     24.7            <span style="color: #BB0000;">NA</span>        0 <span style="color: #BB0000;">NA</span>     A       </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> TRUE      255 A3    Sample 3     26.8            <span style="color: #BB0000;">NA</span>        0 <span style="color: #BB0000;">NA</span>     A       </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> TRUE      255 A4    Sample 4     28.6            <span style="color: #BB0000;">NA</span>        0 <span style="color: #BB0000;">NA</span>     A       </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> TRUE    <span style="text-decoration: underline;">65</span>280 A5    Sample 5     <span style="color: #BB0000;">NA</span>              <span style="color: #BB0000;">NA</span>        0 <span style="color: #BB0000;">NA</span>     A       </span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> TRUE    <span style="text-decoration: underline;">65</span>280 A6    Sample 6     <span style="color: #BB0000;">NA</span>              <span style="color: #BB0000;">NA</span>        0 <span style="color: #BB0000;">NA</span>     A       </span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> TRUE      255 A7    Sample 7     23.2            <span style="color: #BB0000;">NA</span>        0 <span style="color: #BB0000;">NA</span>     A       </span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> TRUE      255 A8    Sample 8     24.8            <span style="color: #BB0000;">NA</span>        0 <span style="color: #BB0000;">NA</span>     A       </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> TRUE      255 A9    Sample 9     26.9            <span style="color: #BB0000;">NA</span>        0 <span style="color: #BB0000;">NA</span>     A       </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> TRUE    <span style="text-decoration: underline;">65</span>280 A10   Sample 10    <span style="color: #BB0000;">NA</span>              <span style="color: #BB0000;">NA</span>        0 <span style="color: #BB0000;">NA</span>     A       </span>
<span class="co">## <span style="color: #949494;"># … with 374 more rows, and 9 more variables: well_col &lt;fct&gt;, dilution &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   dilution_nice &lt;chr&gt;, prep_type &lt;fct&gt;, biol_rep &lt;fct&gt;, tech_rep &lt;fct&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   gene_name &lt;fct&gt;, target_id &lt;fct&gt;, sample_id &lt;chr&gt;</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">plates</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##  include            color           well           sample_info       </span>
<span class="co">##  Mode:logical   Min.   :  255   Length:384         Length:384        </span>
<span class="co">##  TRUE:384       1st Qu.:  255   Class :character   Class :character  </span>
<span class="co">##                 Median :  255   Mode  :character   Mode  :character  </span>
<span class="co">##                 Mean   :18035                                        </span>
<span class="co">##                 3rd Qu.:65280                                        </span>
<span class="co">##                 Max.   :65280                                        </span>
<span class="co">##                                                                      </span>
<span class="co">##        cq        concentration    standard  status           well_row  </span>
<span class="co">##  Min.   :13.89   Min.   : NA   Min.   :0   Mode:logical   A      : 24  </span>
<span class="co">##  1st Qu.:20.55   1st Qu.: NA   1st Qu.:0   NA's:384       B      : 24  </span>
<span class="co">##  Median :23.44   Median : NA   Median :0                  C      : 24  </span>
<span class="co">##  Mean   :23.63   Mean   :NaN   Mean   :0                  D      : 24  </span>
<span class="co">##  3rd Qu.:26.68   3rd Qu.: NA   3rd Qu.:0                  E      : 24  </span>
<span class="co">##  Max.   :36.77   Max.   : NA   Max.   :0                  F      : 24  </span>
<span class="co">##  NA's   :105     NA's   :384                              (Other):240  </span>
<span class="co">##     well_col      dilution      dilution_nice      prep_type biol_rep tech_rep</span>
<span class="co">##  1      : 16   Min.   :0.0080   Length:384         +RT:256   A:192    1:192   </span>
<span class="co">##  2      : 16   1st Qu.:0.0400   Class :character   -RT: 64   B:192    2:192   </span>
<span class="co">##  3      : 16   Median :0.6000   Mode  :character   NT : 64                    </span>
<span class="co">##  4      : 16   Mean   :0.5413                                                 </span>
<span class="co">##  5      : 16   3rd Qu.:1.0000                                                 </span>
<span class="co">##  6      : 16   Max.   :1.0000                                                 </span>
<span class="co">##  (Other):288                                                                  </span>
<span class="co">##  gene_name    target_id    sample_id        </span>
<span class="co">##  ECM38:72   ECM38_1: 24   Length:384        </span>
<span class="co">##  FET5 :72   ECM38_2: 24   Class :character  </span>
<span class="co">##  GPT2 :48   ECM38_3: 24   Mode  :character  </span>
<span class="co">##  ILV5 :48   FET5_1 : 24                     </span>
<span class="co">##  NRD1 :48   FET5_3 : 24                     </span>
<span class="co">##  RDL1 :48   FET5_4 : 24                     </span>
<span class="co">##  TFS1 :48   (Other):240</span></code></pre>
</div>
<div class="section level3">
<h3 id="visualise-cq-values-for-each-well-">Visualise Cq values for each well.<a class="anchor" aria-label="anchor" href="#visualise-cq-values-for-each-well-"></a>
</h3>
<p>Visualising the Cq values shows that the Cq value is different for
each primer set in each row. Within each section of a row for a single
replicate of dilutions, Cq consistently increases with dilutions as
expected. The grey tiles for most -RT and NT columns mean that the value
is <code>NA</code>, i.e. no Cq value was reported. This is good.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/display_plate_value.html">display_plate_value</a></span><span class="op">(</span><span class="va">plates</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/check_edge_effects-1.png" width="576"></p>
<p>Visualisation might also help to identify unwanted positional
effects. For example, a PCR machine is broken, wells close to an edge of
the plate can have different behaviour from central wells.</p>
</div>
<div class="section level3">
<h3 id="plot-unnormalized-data-shows-that--rt-and-nt-controls-are-low">Plot unnormalized data shows that -RT and NT controls are low<a class="anchor" aria-label="anchor" href="#plot-unnormalized-data-shows-that--rt-and-nt-controls-are-low"></a>
</h3>
<p>This plot visualises the Cq data in a way that highlights the meaning
instead of the position on the plate. Again, it shows that the Cq value
is different for each primer set, and that for each primer st Cq
consistently increases with dilutions as expected.</p>
<p>Again, we detect no signal in NT (no template) negative control so
those points are mostly missing. There is a very weak signal with high
Cq in some -RT (no reverse transcriptase) negative controls.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plates</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">target_id</span>,
                 y <span class="op">=</span> <span class="va">cq</span>,
                 colour <span class="op">=</span> <span class="va">dilution_nice</span>,
                 shape <span class="op">=</span> <span class="va">prep_type</span><span class="op">)</span>,
    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"Cycle count to threshold"</span>,
    title <span class="op">=</span> <span class="st">"All reps, unnormalized"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">biol_rep</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">15</span>, to <span class="op">=</span> <span class="fl">35</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,
        panel.grid.major.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">"grey80"</span>, size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plot_unnormalized-1.png" width="864"></p>
</div>
<div class="section level3">
<h3 id="dilution-series-is-linear-for-all-probes">Dilution series is linear for all probes<a class="anchor" aria-label="anchor" href="#dilution-series-is-linear-for-all-probes"></a>
</h3>
<p>Visual display of linearity of cq with log(dilution).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plates</span>, <span class="va">prep_type</span> <span class="op">==</span> <span class="st">"+RT"</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dilution</span>, y <span class="op">=</span> <span class="va">cq</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>
    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"fit"</span>, linetype <span class="op">=</span> <span class="st">"fit"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>
    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"theory"</span>, linetype <span class="op">=</span> <span class="st">"theory"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">10</span> <span class="op">^</span> <span class="op">-</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"Cycle count to threshold"</span>,
    title <span class="op">=</span> <span class="st">"All reps, unnormalized"</span>,
    colour <span class="op">=</span> <span class="st">"Dilution"</span>, linetype <span class="op">=</span> <span class="st">"Dilution"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">biol_rep</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plot_dilutions-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="calculate-primer-efficiencies-for-all-probes">Calculate primer efficiencies for all probes<a class="anchor" aria-label="anchor" href="#calculate-primer-efficiencies-for-all-probes"></a>
</h3>
<p>Use regression to estimate linearity of cq with log(dilution),
including the slope or efficiency.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calculate_efficiency_bytargetid.html">calculate_efficiency_bytargetid</a></span><span class="op">(</span><span class="va">plates</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 16 × 4</span></span>
<span class="co">##    target_id efficiency efficiency.sd r.squared</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> ECM38_1        0.923        0.048<span style="text-decoration: underline;">0</span>     0.970</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> ECM38_2        0.958        0.042<span style="text-decoration: underline;">9</span>     0.975</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> ECM38_3        1.15         0.052<span style="text-decoration: underline;">4</span>     0.974</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> FET5_1         1.05         0.031<span style="text-decoration: underline;">7</span>     0.988</span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> FET5_3         1.09         0.050<span style="text-decoration: underline;">7</span>     0.973</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> FET5_4         1.09         0.041<span style="text-decoration: underline;">3</span>     0.982</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> GPT2_1         1.14         0.060<span style="text-decoration: underline;">1</span>     0.965</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> GPT2_4         1.08         0.034<span style="text-decoration: underline;">5</span>     0.987</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> ILV5_1         1.04         0.022<span style="text-decoration: underline;">2</span>     0.994</span>
<span class="co">## <span style="color: #BCBCBC;">10</span> ILV5_4         1.09         0.023<span style="text-decoration: underline;">9</span>     0.994</span>
<span class="co">## <span style="color: #BCBCBC;">11</span> NRD1_1         0.998        0.049<span style="text-decoration: underline;">8</span>     0.969</span>
<span class="co">## <span style="color: #BCBCBC;">12</span> NRD1_2         1.08         0.042<span style="text-decoration: underline;">3</span>     0.981</span>
<span class="co">## <span style="color: #BCBCBC;">13</span> RDL1_4         1.06         0.038<span style="text-decoration: underline;">6</span>     0.983</span>
<span class="co">## <span style="color: #BCBCBC;">14</span> RDL1_5         1.03         0.032<span style="text-decoration: underline;">7</span>     0.987</span>
<span class="co">## <span style="color: #BCBCBC;">15</span> TFS1_1         1.03         0.055<span style="text-decoration: underline;">1</span>     0.964</span>
<span class="co">## <span style="color: #BCBCBC;">16</span> TFS1_5         1.18         0.054<span style="text-decoration: underline;">4</span>     0.973</span></code></pre>
</div>
<div class="section level3">
<h3 id="dilution-series-for-nice-probes-only-shows-linearity-clearly">Dilution series for nice probes only shows linearity clearly<a class="anchor" aria-label="anchor" href="#dilution-series-for-nice-probes-only-shows-linearity-clearly"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">target_id_levels_niceprobes</span> <span class="op">&lt;-</span> 
    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ECM38_3"</span>, <span class="st">"FET5_1"</span>, <span class="st">"GPT2_4"</span>, <span class="st">"ILV5_4"</span>,
      <span class="st">"NRD1_1"</span>,  <span class="st">"RDL1_4"</span>, <span class="st">"TFS1_1"</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plates</span>,
                <span class="va">prep_type</span> <span class="op">==</span> <span class="st">"+RT"</span>,
                <span class="va">target_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">target_id_levels_niceprobes</span><span class="op">)</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dilution</span>, y <span class="op">=</span> <span class="va">cq</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>
    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"fit"</span>, linetype <span class="op">=</span> <span class="st">"fit"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>
    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
    method <span class="op">=</span> <span class="st">"lm"</span>,
    se <span class="op">=</span> <span class="cn">FALSE</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"theory"</span>, linetype <span class="op">=</span> <span class="st">"theory"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">10</span> <span class="op">^</span> <span class="op">-</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"Cycle count to threshold"</span>,
    title <span class="op">=</span> <span class="st">"All reps, unnormalized"</span>,
    colour <span class="op">=</span> <span class="st">"Dilution"</span>, linetype <span class="op">=</span> <span class="st">"Dilution"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">biol_rep</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plot_dilutions_nice-1.png" width="384"></p>
</div>
</div>
<div class="section level2">
<h2 id="analyse-amplification-and-melt-curve-data">Analyse amplification and melt curve data<a class="anchor" aria-label="anchor" href="#analyse-amplification-and-melt-curve-data"></a>
</h2>
<div class="section level3">
<h3 id="load-raw-data-for-amplification-and-melt-curves-">Load raw data for amplification and melt curves.<a class="anchor" aria-label="anchor" href="#load-raw-data-for-amplification-and-melt-curves-"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># NOTE: system.file() accesses data from this R package</span>
<span class="co"># To use your own data, remove the call to system.file(),</span>
<span class="co"># instead pass your data's filename to read_lightcycler_1colour_cq()</span>
<span class="co"># or to another relevant read_ function</span>

<span class="va">file_path_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Edward_qPCR_Nrd1_calibration_2019-02-02.txt.gz"</span>,
                             package <span class="op">=</span> <span class="st">"tidyqpcr"</span><span class="op">)</span>

<span class="va">plate1curve</span> <span class="op">&lt;-</span> <span class="va">file_path_raw</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="../reference/read_lightcycler_1colour_raw.html">read_lightcycler_1colour_raw</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="../reference/debaseline.html">debaseline</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">plate1plan</span>, by <span class="op">=</span> <span class="st">"well"</span><span class="op">)</span>

<span class="co"># amplification curve is program 2</span>
<span class="va">platesamp</span> <span class="op">&lt;-</span> <span class="va">plate1curve</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">program_no</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>

<span class="co"># melt curve is program 3 or 4, depending on cycler setting</span>
<span class="va">platesmelt</span> <span class="op">&lt;-</span> <span class="va">plate1curve</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">program_no</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/calculate_drdt_plate.html">calculate_drdt_plate</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">temperature</span> <span class="op">&gt;=</span> <span class="fl">61</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-de-baselined-raw-data-for-single-well">Plot de-baseline’d raw data for single well<a class="anchor" aria-label="anchor" href="#plot-de-baselined-raw-data-for-single-well"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesamp</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">well</span> <span class="op">==</span> <span class="st">"A1"</span><span class="op">)</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cycle</span>, y <span class="op">=</span> <span class="va">fluor_signal</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotamp_A1-1.png" width="384"></p>
</div>
<div class="section level3">
<h3 id="plot-all-amplification-curves">Plot all amplification curves<a class="anchor" aria-label="anchor" href="#plot-all-amplification-curves"></a>
</h3>
<p>Broken up by technical replicate here, to avoid overplotting.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesamp</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cycle</span>,
      y <span class="op">=</span> <span class="va">fluor_signal</span>,
      colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dilution</span><span class="op">)</span>,
      linetype <span class="op">=</span> <span class="va">prep_type</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">biol_rep</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+RT"</span> <span class="op">=</span> <span class="st">"solid"</span>,
                                   <span class="st">"-RT"</span> <span class="op">=</span> <span class="st">"dashed"</span>,
                                   <span class="st">"NT"</span> <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>,
                     minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"All Amp Curves, tech_rep A"</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotamp_all-1.png" width="672"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesamp</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"2"</span><span class="op">)</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cycle</span>,
      y <span class="op">=</span> <span class="va">fluor_signal</span>,
      colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dilution</span><span class="op">)</span>,
      linetype <span class="op">=</span> <span class="va">prep_type</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">biol_rep</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+RT"</span> <span class="op">=</span> <span class="st">"solid"</span>,
                                   <span class="st">"-RT"</span> <span class="op">=</span> <span class="st">"dashed"</span>,
                                   <span class="st">"NT"</span> <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>,
                     minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"All Amp Curves, tech_rep B"</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotamp_all-2.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="plot-melt-curve-for-single-well">Plot melt curve for single well<a class="anchor" aria-label="anchor" href="#plot-melt-curve-for-single-well"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesmelt</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">well</span> <span class="op">==</span> <span class="st">"A1"</span><span class="op">)</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature</span>, y <span class="op">=</span> <span class="va">dRdT</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">target_id</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.02</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotmelt_A1-1.png" width="384"></p>
</div>
<div class="section level3">
<h3 id="plot-all-melt-curves">Plot all melt curves<a class="anchor" aria-label="anchor" href="#plot-all-melt-curves"></a>
</h3>
<p>Again broken up by technical replicate.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesmelt</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature</span>,
      y <span class="op">=</span> <span class="va">dRdT</span>,
      colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dilution</span><span class="op">)</span>,
      linetype <span class="op">=</span> <span class="va">prep_type</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">biol_rep</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+RT"</span> <span class="op">=</span> <span class="st">"solid"</span>,
                                   <span class="st">"-RT"</span> <span class="op">=</span> <span class="st">"dashed"</span>,
                                   <span class="st">"NT"</span> <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>,
                     minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"All Melt Curves, tech_rep A"</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotmelt_all-1.png" width="672"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesmelt</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"2"</span><span class="op">)</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature</span>,
      y <span class="op">=</span> <span class="va">dRdT</span>,
      colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dilution</span><span class="op">)</span>,
      linetype <span class="op">=</span> <span class="va">prep_type</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">biol_rep</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+RT"</span> <span class="op">=</span> <span class="st">"solid"</span>,
                                   <span class="st">"-RT"</span> <span class="op">=</span> <span class="st">"dashed"</span>,
                                   <span class="st">"NT"</span> <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>,
                     minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"All Melt Curves, tech_rep B"</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotmelt_all-2.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="plot-zoomed-melt-curves">Plot zoomed melt curves<a class="anchor" aria-label="anchor" href="#plot-zoomed-melt-curves"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesmelt</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"1"</span>, <span class="va">prep_type</span> <span class="op">==</span> <span class="st">"+RT"</span><span class="op">)</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature</span>, y <span class="op">=</span> <span class="va">dRdT</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dilution</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">biol_rep</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span>,
    minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,
    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">73</span>, <span class="fl">87</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Melt curves, zoomed, tech_rep A"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>
    panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey50"</span>, size <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,
    panel.grid.minor.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey70"</span>, size <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotmelt_zoomed-1.png" width="672"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesmelt</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"2"</span>, <span class="va">prep_type</span> <span class="op">==</span> <span class="st">"+RT"</span><span class="op">)</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature</span>, y <span class="op">=</span> <span class="va">dRdT</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dilution</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">biol_rep</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span>,
    minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,
    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">73</span>, <span class="fl">87</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Melt curves, zoomed, tech_rep B"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>
    panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey50"</span>, size <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,
    panel.grid.minor.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey70"</span>, size <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotmelt_zoomed-2.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="plot-only-zoomed-melt-curves-for-nice-probes">Plot only zoomed melt curves for nice probes<a class="anchor" aria-label="anchor" href="#plot-only-zoomed-melt-curves-for-nice-probes"></a>
</h3>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesmelt</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span>
      <span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"1"</span>,
      <span class="va">prep_type</span> <span class="op">==</span> <span class="st">"+RT"</span>,
      <span class="va">dilution_nice</span> <span class="op">==</span> <span class="st">"1x"</span>,
      <span class="va">target_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">target_id_levels_niceprobes</span>
    <span class="op">)</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature</span>, y <span class="op">=</span> <span class="va">dRdT</span>, colour <span class="op">=</span> <span class="va">biol_rep</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">.</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span>,
    minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,
    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">73</span>, <span class="fl">87</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Nice probes, tech_rep A"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>
    panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey50"</span>, size <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,
    panel.grid.minor.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey70"</span>, size <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotmelt_zoomed_nice-1.png" width="384"></p>
</div>
</div>
<div class="section level2">
<h2 id="conclude-acceptable-primer-sets">Conclude acceptable primer sets<a class="anchor" aria-label="anchor" href="#conclude-acceptable-primer-sets"></a>
</h2>
<p>These probes have sensible standard curves, amplification curves,
melt curves. In tie-breakers we pick the more highly detected probe.</p>
<ul>
<li>ECM38 set 3</li>
<li>FET5 set 1 or 4</li>
<li>GPT2 set 4</li>
<li>ILV5 set 4</li>
<li>NRD1 set 1 or 2</li>
<li>RDL1 set 4</li>
<li>TFS1 set 1</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Edward Wallace.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
