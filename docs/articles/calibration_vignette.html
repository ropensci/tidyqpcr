<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Primers and probes calibration vignette • tidyqpcr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Primers and probes calibration vignette">
<meta property="og:description" content="tidyqpcr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidyqpcr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/calibration_vignette.html">Primers and probes calibration vignette</a>
    </li>
    <li>
      <a href="../articles/deltacq_96well_vignette.html">Delta Cq 96-well plate qPCR analysis example</a>
    </li>
    <li>
      <a href="../articles/multifactor_vignette.html">Multifactorial multi-plate qPCR analysis example</a>
    </li>
    <li>
      <a href="../articles/platesetup_vignette.html">Introduction to designing an experiment and setting up a plate plan in tidyqpcr</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ewallace/tidyqpcr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Primers and probes calibration vignette</h1>
                        <h4 data-toc-skip class="author">Edward Wallace</h4>
            
            <h4 data-toc-skip class="date">Feb 2019</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ewallace/tidyqpcr/blob/master/vignettes/calibration_vignette.Rmd" class="external-link"><code>vignettes/calibration_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>calibration_vignette.Rmd</code></div>

    </div>

    
    
<div id="summary-calibrating-primer-sets-from-a-real-experimental-test" class="section level1">
<h1 class="hasAnchor">
<a href="#summary-calibrating-primer-sets-from-a-real-experimental-test" class="anchor" aria-hidden="true"></a>Summary: calibrating primer sets from a real experimental test</h1>
<p>This vignette shows how to use tidyqpcr functions to calibrate qPCR probes.</p>
<p>This is real qPCR data by Edward Wallace in Feb 2019, testing new RT-qPCR primer sets against <em>S. cerevisiae</em> genes. We took exponential-phase total RNA previously extracted by Jamie Auxillos.</p>
<p>We tested 2-3 primer sets each for 7 genes:</p>
<ul>
<li>ECM38/ YLR299W (3 primer sets)</li>
<li>FET5 / YFL041W (3 primer sets)</li>
<li>GPT2/YKR067W</li>
<li>ILV5/YLR355C</li>
<li>NRD1/YNL251C (ordered 3rd primer set not tested today)</li>
<li>RDL1/YOR285W</li>
<li>TFS1/YLR178C</li>
</ul>
<p>We started with two biological replicate RNA samples, treated with DNase and then split for a test sample with reverse transcriptase (RT) and negative control without reverse transcriptase (-RT). We also took a no template (NT) negative control. For each RT reaction we do serial 5x dilutions down to 125x to form a quantitative calibration curve.</p>
<p>The data were measured on a Roche LC480 instrument in a single 384-well plate. Quantification was performed in the Roche LightCycler software prior to using this program.</p>
</div>
<div id="set-up-experiment" class="section level1">
<h1 class="hasAnchor">
<a href="#set-up-experiment" class="anchor" aria-hidden="true"></a>Set up experiment</h1>
<div id="label-and-plan-plates" class="section level2">
<h2 class="hasAnchor">
<a href="#label-and-plan-plates" class="anchor" aria-hidden="true"></a>Label and plan plates</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Names of target genes</span>
<span class="va">gene_name_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ECM38"</span>, <span class="st">"FET5"</span>, <span class="st">"GPT2"</span>, <span class="st">"ILV5"</span>, <span class="st">"NRD1"</span>, <span class="st">"RDL1"</span>, <span class="st">"TFS1"</span><span class="op">)</span>
<span class="co"># ORF ids of target genes</span>
<span class="va">target_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"YLR299W"</span>, <span class="st">"YFL041W"</span>, <span class="st">"YKR067W"</span>, <span class="st">"YLR355C"</span>,
                   <span class="st">"YNL251C"</span>, <span class="st">"YOR285W"</span>, <span class="st">"YLR178C"</span><span class="op">)</span>
<span class="co"># Repeats of gene names to account for testing multiple primer sets</span>
<span class="va">gene_name_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">gene_name_levels</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
              <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">gene_name_levels</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co"># id numbers of multiple probesets (reflecting IDs as ordered)</span>
<span class="va">target_id_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">gene_name_values</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,
  sep <span class="op">=</span> <span class="st">"_"</span>
<span class="op">)</span>


<span class="va">rowkey</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  well_row <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span>,
  gene_name <span class="op">=</span> <span class="va">gene_name_values</span>,
  target_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">target_id_levels</span>, levels <span class="op">=</span> <span class="va">target_id_levels</span><span class="op">)</span>
<span class="op">)</span>


<span class="va">plate1plan</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/label_plate_rowcol.html">label_plate_rowcol</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/create_blank_plate.html">create_blank_plate</a></span><span class="op">(</span><span class="op">)</span>,
    <span class="va">rowkey</span>,
    <span class="fu"><a href="../reference/create_colkey_4diln_2ctrl_in_24.html">create_colkey_4diln_2ctrl_in_24</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>sample_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">biol_rep</span>, <span class="va">dilution_nice</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="spot-check-the-plate-plan" class="section level2">
<h2 class="hasAnchor">
<a href="#spot-check-the-plate-plan" class="anchor" aria-hidden="true"></a>Spot-check the plate plan</h2>
<p>Checks that for selected techrep/probe/dilution combinations, the plate contains the right number of replicates.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plate1plan</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"1"</span>,
         <span class="va">target_id</span> <span class="op">==</span> <span class="va">target_id_levels</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
         <span class="va">dilution_nice</span> <span class="op">==</span> <span class="st">"1x"</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 11
##   well  well_row well_col dilution dilution_nice prep_type biol_rep tech_rep
##   &lt;chr&gt; &lt;fct&gt;    &lt;fct&gt;       &lt;dbl&gt; &lt;chr&gt;         &lt;fct&gt;     &lt;fct&gt;    &lt;fct&gt;   
## 1 A1    A        1               1 1x            +RT       A        1       
## 2 A13   A        13              1 1x            +RT       B        1       
## # … with 3 more variables: gene_name &lt;chr&gt;, target_id &lt;fct&gt;, sample_id &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plate1plan</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"2"</span>,
         <span class="va">target_id</span> <span class="op">==</span> <span class="va">target_id_levels</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 12 x 11
##    well  well_row well_col dilution dilution_nice prep_type biol_rep tech_rep
##    &lt;chr&gt; &lt;fct&gt;    &lt;fct&gt;       &lt;dbl&gt; &lt;chr&gt;         &lt;fct&gt;     &lt;fct&gt;    &lt;fct&gt;   
##  1 D7    D        7           1     1x            +RT       A        2       
##  2 D8    D        8           0.2   5x            +RT       A        2       
##  3 D9    D        9           0.04  25x           +RT       A        2       
##  4 D10   D        10          0.008 125x          +RT       A        2       
##  5 D11   D        11          1     -RT           -RT       A        2       
##  6 D12   D        12          1     NT            NT        A        2       
##  7 D19   D        19          1     1x            +RT       B        2       
##  8 D20   D        20          0.2   5x            +RT       B        2       
##  9 D21   D        21          0.04  25x           +RT       B        2       
## 10 D22   D        22          0.008 125x          +RT       B        2       
## 11 D23   D        23          1     -RT           -RT       B        2       
## 12 D24   D        24          1     NT            NT        B        2       
## # … with 3 more variables: gene_name &lt;chr&gt;, target_id &lt;fct&gt;, sample_id &lt;chr&gt;</code></pre>
</div>
<div id="display-the-plate-plan" class="section level2">
<h2 class="hasAnchor">
<a href="#display-the-plate-plan" class="anchor" aria-hidden="true"></a>Display the plate plan</h2>
<p>This can be printed out to facilitate loading the plate correctly.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/display_plate.html">display_plate</a></span><span class="op">(</span><span class="va">plate1plan</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/display_plates-1.png" width="1152"></p>
</div>
</div>
<div id="analyze-cq-quantification-cycle-count-data" class="section level1">
<h1 class="hasAnchor">
<a href="#analyze-cq-quantification-cycle-count-data" class="anchor" aria-hidden="true"></a>Analyze Cq (quantification cycle count) data</h1>
<div id="load-and-summarize-data" class="section level2">
<h2 class="hasAnchor">
<a href="#load-and-summarize-data" class="anchor" aria-hidden="true"></a>Load and summarize data</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_lightcycler_1colour_cq.html">read_lightcycler_1colour_cq</a></span><span class="op">(</span>
  <span class="st">"../inst/extdata/Edward_qPCR_Nrd1_calibration_2019-02-02_Ct.txt"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">right_join</span><span class="op">(</span><span class="va">plate1plan</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plates</span></code></pre></div>
<pre><code>## # A tibble: 384 x 18
##    include color well  sample_info    cq concentration standard status well_row
##    &lt;lgl&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;         &lt;dbl&gt;    &lt;int&gt; &lt;lgl&gt;  &lt;fct&gt;   
##  1 TRUE      255 A1    Sample 1     22.8            NA        0 NA     A       
##  2 TRUE      255 A2    Sample 2     24.7            NA        0 NA     A       
##  3 TRUE      255 A3    Sample 3     26.8            NA        0 NA     A       
##  4 TRUE      255 A4    Sample 4     28.6            NA        0 NA     A       
##  5 TRUE    65280 A5    Sample 5     NA              NA        0 NA     A       
##  6 TRUE    65280 A6    Sample 6     NA              NA        0 NA     A       
##  7 TRUE      255 A7    Sample 7     23.2            NA        0 NA     A       
##  8 TRUE      255 A8    Sample 8     24.8            NA        0 NA     A       
##  9 TRUE      255 A9    Sample 9     26.9            NA        0 NA     A       
## 10 TRUE    65280 A10   Sample 10    NA              NA        0 NA     A       
## # … with 374 more rows, and 9 more variables: well_col &lt;fct&gt;, dilution &lt;dbl&gt;,
## #   dilution_nice &lt;chr&gt;, prep_type &lt;fct&gt;, biol_rep &lt;fct&gt;, tech_rep &lt;fct&gt;,
## #   gene_name &lt;chr&gt;, target_id &lt;fct&gt;, sample_id &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">plates</span><span class="op">)</span></code></pre></div>
<pre><code>##  include            color           well           sample_info       
##  Mode:logical   Min.   :  255   Length:384         Length:384        
##  TRUE:384       1st Qu.:  255   Class :character   Class :character  
##                 Median :  255   Mode  :character   Mode  :character  
##                 Mean   :18035                                        
##                 3rd Qu.:65280                                        
##                 Max.   :65280                                        
##                                                                      
##        cq        concentration    standard  status           well_row  
##  Min.   :13.89   Min.   : NA   Min.   :0   Mode:logical   A      : 24  
##  1st Qu.:20.55   1st Qu.: NA   1st Qu.:0   NA's:384       B      : 24  
##  Median :23.44   Median : NA   Median :0                  C      : 24  
##  Mean   :23.63   Mean   :NaN   Mean   :0                  D      : 24  
##  3rd Qu.:26.68   3rd Qu.: NA   3rd Qu.:0                  E      : 24  
##  Max.   :36.77   Max.   : NA   Max.   :0                  F      : 24  
##  NA's   :105     NA's   :384                              (Other):240  
##     well_col      dilution      dilution_nice      prep_type biol_rep tech_rep
##  1      : 16   Min.   :0.0080   Length:384         +RT:256   A:192    1:192   
##  2      : 16   1st Qu.:0.0400   Class :character   -RT: 64   B:192    2:192   
##  3      : 16   Median :0.6000   Mode  :character   NT : 64                    
##  4      : 16   Mean   :0.5413                                                 
##  5      : 16   3rd Qu.:1.0000                                                 
##  6      : 16   Max.   :1.0000                                                 
##  (Other):288                                                                  
##   gene_name           target_id    sample_id        
##  Length:384         ECM38_1: 24   Length:384        
##  Class :character   ECM38_2: 24   Class :character  
##  Mode  :character   ECM38_3: 24   Mode  :character  
##                     FET5_1 : 24                     
##                     FET5_3 : 24                     
##                     FET5_4 : 24                     
##                     (Other):240</code></pre>
</div>
<div id="plot-unnormalized-data-shows-that--rt-and-nt-controls-are-low" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-unnormalized-data-shows-that--rt-and-nt-controls-are-low" class="anchor" aria-hidden="true"></a>Plot unnormalized data shows that -RT and NT controls are low</h2>
<p>We detect no signal in NT (no template) negative control, and very weak signal in -RT (no reverse transcriptase) negative controls.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">plates</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">target_id</span>,
                 y <span class="op">=</span> <span class="va">cq</span>,
                 colour <span class="op">=</span> <span class="va">dilution_nice</span>,
                 shape <span class="op">=</span> <span class="va">prep_type</span><span class="op">)</span>,
    position <span class="op">=</span> <span class="fu">position_jitter</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"Cycle count to threshold"</span>,
    title <span class="op">=</span> <span class="st">"All reps, unnormalized"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">biol_rep</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">panel_border</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plot_unnormalized-1.png" width="864"></p>
</div>
<div id="dilution-series-is-linear-for-all-probes" class="section level2">
<h2 class="hasAnchor">
<a href="#dilution-series-is-linear-for-all-probes" class="anchor" aria-hidden="true"></a>Dilution series is linear for all probes</h2>
<p>Visual display of linearity of cq with log(dilution).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plates</span>, <span class="va">prep_type</span> <span class="op">==</span> <span class="st">"+RT"</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">dilution</span>, y <span class="op">=</span> <span class="va">cq</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">stat_smooth</span><span class="op">(</span>
    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>,
    <span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"fit"</span>, linetype <span class="op">=</span> <span class="st">"fit"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">stat_smooth</span><span class="op">(</span>
    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>,
    <span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"theory"</span>, linetype <span class="op">=</span> <span class="st">"theory"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_log10</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">10</span> <span class="op">^</span> <span class="op">-</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"Cycle count to threshold"</span>,
    title <span class="op">=</span> <span class="st">"All reps, unnormalized"</span>,
    colour <span class="op">=</span> <span class="st">"Dilution"</span>, linetype <span class="op">=</span> <span class="st">"Dilution"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">biol_rep</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plot_dilutions-1.png" width="576"></p>
</div>
<div id="calculate-primer-efficiencies-for-all-probes" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-primer-efficiencies-for-all-probes" class="anchor" aria-hidden="true"></a>Calculate primer efficiencies for all probes</h2>
<p>Use regression to estimate linearity of cq with log(dilution), including the slope or efficiency.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calculate_efficiency_bytargetid.html">calculate_efficiency_bytargetid</a></span><span class="op">(</span><span class="va">plates</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 16 x 4
##    target_id efficiency efficiency.sd r.squared
##    &lt;fct&gt;          &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;
##  1 ECM38_1        0.923        0.0480     0.970
##  2 ECM38_2        0.958        0.0429     0.975
##  3 ECM38_3        1.15         0.0524     0.974
##  4 FET5_1         1.05         0.0317     0.988
##  5 FET5_3         1.09         0.0507     0.973
##  6 FET5_4         1.09         0.0413     0.982
##  7 GPT2_1         1.14         0.0601     0.965
##  8 GPT2_4         1.08         0.0345     0.987
##  9 ILV5_1         1.04         0.0222     0.994
## 10 ILV5_4         1.09         0.0239     0.994
## 11 NRD1_1         0.998        0.0498     0.969
## 12 NRD1_2         1.08         0.0423     0.981
## 13 RDL1_4         1.06         0.0386     0.983
## 14 RDL1_5         1.03         0.0327     0.987
## 15 TFS1_1         1.03         0.0551     0.964
## 16 TFS1_5         1.18         0.0544     0.973</code></pre>
</div>
<div id="dilution-series-for-nice-probes-only-shows-linearity-clearly" class="section level2">
<h2 class="hasAnchor">
<a href="#dilution-series-for-nice-probes-only-shows-linearity-clearly" class="anchor" aria-hidden="true"></a>Dilution series for nice probes only shows linearity clearly</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">target_id_levels_nice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ECM38_3"</span>, <span class="st">"FET5_1"</span>, <span class="st">"GPT2_4"</span>, <span class="st">"ILV5_4"</span>,
                           <span class="st">"NRD1_1"</span>, <span class="st">"RDL1_4"</span>, <span class="st">"TFS1_1"</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>
  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plates</span>,
                <span class="va">prep_type</span> <span class="op">==</span> <span class="st">"+RT"</span>,
                <span class="va">target_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">target_id_levels_nice</span><span class="op">)</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">dilution</span>, y <span class="op">=</span> <span class="va">cq</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">stat_smooth</span><span class="op">(</span>
    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>,
    <span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"fit"</span>, linetype <span class="op">=</span> <span class="st">"fit"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">stat_smooth</span><span class="op">(</span>
    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
    method <span class="op">=</span> <span class="st">"lm"</span>,
    se <span class="op">=</span> <span class="cn">FALSE</span>,
    <span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"theory"</span>, linetype <span class="op">=</span> <span class="st">"theory"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_log10</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">10</span> <span class="op">^</span> <span class="op">-</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"Cycle count to threshold"</span>,
    title <span class="op">=</span> <span class="st">"All reps, unnormalized"</span>,
    colour <span class="op">=</span> <span class="st">"Dilution"</span>, linetype <span class="op">=</span> <span class="st">"Dilution"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">biol_rep</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plot_dilutions_nice-1.png" width="384"></p>
</div>
</div>
<div id="analyze-amplification-and-melt-curve-data" class="section level1">
<h1 class="hasAnchor">
<a href="#analyze-amplification-and-melt-curve-data" class="anchor" aria-hidden="true"></a>Analyze amplification and melt curve data</h1>
<div id="load-raw-data-for-amplification-and-melt-curves-" class="section level2">
<h2 class="hasAnchor">
<a href="#load-raw-data-for-amplification-and-melt-curves-" class="anchor" aria-hidden="true"></a>Load raw data for amplification and melt curves.</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plate1curve</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_lightcycler_1colour_raw.html">read_lightcycler_1colour_raw</a></span><span class="op">(</span>
  <span class="st">"../inst/extdata/Edward_qPCR_Nrd1_calibration_2019-02-02.txt"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/debaseline.html">debaseline</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">left_join</span><span class="op">(</span><span class="va">plate1plan</span><span class="op">)</span>

<span class="co"># amplification curve is program 2</span>
<span class="va">platesamp</span> <span class="op">&lt;-</span> <span class="va">plate1curve</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">program_no</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>

<span class="co"># melt curve is program 3 or 4, depending on cycler setting</span>
<span class="va">platesmelt</span> <span class="op">&lt;-</span> <span class="va">plate1curve</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">program_no</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/calculate_drdt_plate.html">calculate_drdt_plate</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">temperature</span> <span class="op">&gt;=</span> <span class="fl">61</span><span class="op">)</span></code></pre></div>
</div>
<div id="plot-de-baselined-raw-data-for-single-well" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-de-baselined-raw-data-for-single-well" class="anchor" aria-hidden="true"></a>Plot de-baseline’d raw data for single well</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesamp</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">well</span> <span class="op">==</span> <span class="st">"A1"</span><span class="op">)</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cycle</span>, y <span class="op">=</span> <span class="va">fluor_signal</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotamp_A1-1.png" width="384"></p>
</div>
<div id="plot-all-amplification-curves" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-all-amplification-curves" class="anchor" aria-hidden="true"></a>Plot all amplification curves</h2>
<p>Broken up by technical replicate here, to avoid overplotting.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesamp</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cycle</span>,
      y <span class="op">=</span> <span class="va">fluor_signal</span>,
      colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dilution</span><span class="op">)</span>,
      linetype <span class="op">=</span> <span class="va">prep_type</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">biol_rep</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_linetype_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+RT"</span> <span class="op">=</span> <span class="st">"solid"</span>,
                                   <span class="st">"-RT"</span> <span class="op">=</span> <span class="st">"dashed"</span>,
                                   <span class="st">"NT"</span> <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>,
                     minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"All Amp Curves, tech_rep A"</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotamp_all-1.png" width="672"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesamp</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"2"</span><span class="op">)</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cycle</span>,
      y <span class="op">=</span> <span class="va">fluor_signal</span>,
      colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dilution</span><span class="op">)</span>,
      linetype <span class="op">=</span> <span class="va">prep_type</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">biol_rep</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_linetype_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+RT"</span> <span class="op">=</span> <span class="st">"solid"</span>,
                                   <span class="st">"-RT"</span> <span class="op">=</span> <span class="st">"dashed"</span>,
                                   <span class="st">"NT"</span> <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>,
                     minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"All Amp Curves, tech_rep B"</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotamp_all-2.png" width="672"></p>
</div>
<div id="plot-melt-curve-for-single-well" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-melt-curve-for-single-well" class="anchor" aria-hidden="true"></a>Plot melt curve for single well</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesmelt</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">well</span> <span class="op">==</span> <span class="st">"A1"</span><span class="op">)</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature</span>, y <span class="op">=</span> <span class="va">dRdT</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">target_id</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.02</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotmelt_A1-1.png" width="384"></p>
</div>
<div id="plot-all-melt-curves" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-all-melt-curves" class="anchor" aria-hidden="true"></a>Plot all melt curves</h2>
<p>Again broken up by technical replicate.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesmelt</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature</span>,
      y <span class="op">=</span> <span class="va">dRdT</span>,
      colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dilution</span><span class="op">)</span>,
      linetype <span class="op">=</span> <span class="va">prep_type</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">biol_rep</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_linetype_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+RT"</span> <span class="op">=</span> <span class="st">"solid"</span>,
                                   <span class="st">"-RT"</span> <span class="op">=</span> <span class="st">"dashed"</span>,
                                   <span class="st">"NT"</span> <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>,
                     minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"All Melt Curves, tech_rep A"</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotmelt_all-1.png" width="672"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesmelt</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"2"</span><span class="op">)</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature</span>,
      y <span class="op">=</span> <span class="va">dRdT</span>,
      colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dilution</span><span class="op">)</span>,
      linetype <span class="op">=</span> <span class="va">prep_type</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">biol_rep</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_linetype_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+RT"</span> <span class="op">=</span> <span class="st">"solid"</span>,
                                   <span class="st">"-RT"</span> <span class="op">=</span> <span class="st">"dashed"</span>,
                                   <span class="st">"NT"</span> <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>,
                     minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"All Melt Curves, tech_rep B"</span><span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotmelt_all-2.png" width="672"></p>
</div>
<div id="plot-zoomed-melt-curves" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-zoomed-melt-curves" class="anchor" aria-hidden="true"></a>Plot zoomed melt curves</h2>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesmelt</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"1"</span>, <span class="va">prep_type</span> <span class="op">==</span> <span class="st">"+RT"</span><span class="op">)</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature</span>, y <span class="op">=</span> <span class="va">dRdT</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dilution</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">biol_rep</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span>,
    minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,
    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">73</span>, <span class="fl">87</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Melt curves, zoomed, tech_rep A"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    panel.grid.major.x <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey50"</span>, size <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,
    panel.grid.minor.x <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey70"</span>, size <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotmelt_zoomed-1.png" width="672"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesmelt</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"2"</span>, <span class="va">prep_type</span> <span class="op">==</span> <span class="st">"+RT"</span><span class="op">)</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature</span>, y <span class="op">=</span> <span class="va">dRdT</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dilution</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">biol_rep</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span>,
    minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,
    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">73</span>, <span class="fl">87</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Melt curves, zoomed, tech_rep B"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    panel.grid.major.x <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey50"</span>, size <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,
    panel.grid.minor.x <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey70"</span>, size <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotmelt_zoomed-2.png" width="672"></p>
</div>
<div id="plot-only-zoomed-melt-curves-for-nice-probes" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-only-zoomed-melt-curves-for-nice-probes" class="anchor" aria-hidden="true"></a>Plot only zoomed melt curves for nice probes</h2>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">target_id_levels_nice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ECM38_3"</span>, <span class="st">"FET5_1"</span>, <span class="st">"GPT2_4"</span>, <span class="st">"ILV5_4"</span>,
                           <span class="st">"NRD1_1"</span>, <span class="st">"RDL1_4"</span>, <span class="st">"TFS1_1"</span><span class="op">)</span>
<span class="fu">ggplot</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">platesmelt</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span>
      <span class="va">tech_rep</span> <span class="op">==</span> <span class="st">"1"</span>,
      <span class="va">prep_type</span> <span class="op">==</span> <span class="st">"+RT"</span>,
      <span class="va">dilution_nice</span> <span class="op">==</span> <span class="st">"1x"</span>,
      <span class="va">target_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">target_id_levels_nice</span>
    <span class="op">)</span>,
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature</span>, y <span class="op">=</span> <span class="va">dRdT</span>, colour <span class="op">=</span> <span class="va">biol_rep</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">target_id</span> <span class="op">~</span> <span class="va">.</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span>,
    minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,
    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">73</span>, <span class="fl">87</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Nice probes, tech_rep A"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>
    panel.grid.major.x <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey50"</span>, size <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,
    panel.grid.minor.x <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey70"</span>, size <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p><img src="calibration_vignette_files/figure-html/plotmelt_zoomed_nice-1.png" width="384"></p>
</div>
</div>
<div id="conclude-acceptable-primer-sets" class="section level1">
<h1 class="hasAnchor">
<a href="#conclude-acceptable-primer-sets" class="anchor" aria-hidden="true"></a>Conclude acceptable primer sets</h1>
<p>These probes have sensible standard curves, amplification curves, melt curves. In tie-breakers we pick the more highly detected probe.</p>
<ul>
<li>ECM38 set 3</li>
<li>FET5 set 1 or 4</li>
<li>GPT2 set 4</li>
<li>ILV5 set 4</li>
<li>NRD1 set 1 or 2</li>
<li>RDL1 set 4</li>
<li>TFS1 set 1</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Edward Wallace.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
